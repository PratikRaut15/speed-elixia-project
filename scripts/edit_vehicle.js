jQuery(document).ready(function () {
    jQuery('#PDate').datepicker({format: "dd-mm-yyyy", autoclose: true});

    jQuery('#taxDate').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#permitDate').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#fitDate').datepicker({format: "dd-mm-yyyy", autoclose: true});
    
    jQuery('#AgrStartDate').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#AgrEndDate').datepicker({format: "dd-mm-yyyy", autoclose: true});
    
    
    

    jQuery('#RDate').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#ExpDate').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#ExpiryDate_PUC').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#ExpiryDate_REG').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#ExpiryDate_INS').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#ExpiryDate_OTH1').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#ExpiryDate_OTH2').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#ExpiryDate_OTH3').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#ExpiryDate_OTH4').datepicker({format: "dd-mm-yyyy", autoclose: true});

    jQuery('#cap_EDate').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#StartDate').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#EndDate').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#StartDateloan').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#EndDateloan').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#invoice_date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#registrationdate').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#from_date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#to_date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#edit_from_date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#edit_to_date').datepicker({format: "dd-mm-yyyy", autoclose: true});

    jQuery('#batt_vehicle_in_date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#batt_vehicle_out_date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#batt_invoice_date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#batt_payment_submission_date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#batt_payment_approval_date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#batt_submission_date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#batt_approval_date').datepicker({format: "dd-mm-yyyy", autoclose: true});

    jQuery('#getbattery_edit #batt_payment_submission_date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#getbattery_edit #batt_payment_approval_date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#getbattery_edit #batt_submission_date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#getbattery_edit #batt_approval_date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#getbattery_edit #batt_vehicle_in_date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#getbattery_edit #batt_vehicle_out_date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#getbattery_edit #batt_invoice_date').datepicker({format: "dd-mm-yyyy", autoclose: true});

    jQuery('#tyre_vehicle_in_date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#tyre_vehicle_out_date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#tyre_invoice_date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#tyre_payment_submission_date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#tyre_payment_approval_date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#tyre_submission_date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#tyre_approval_date').datepicker({format: "dd-mm-yyyy", autoclose: true});

    jQuery('#gettyre_edit #tyre_payment_submission_date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#gettyre_edit #tyre_payment_approval_date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#gettyre_edit #tyre_submission_date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#gettyre_edit #tyre_approval_date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#gettyre_edit #tyre_vehicle_in_date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#gettyre_edit #tyre_vehicle_out_date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#gettyre_edit #tyre_invoice_date').datepicker({format: "dd-mm-yyyy", autoclose: true});

    jQuery('#repair_vehicle_in_date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#repair_vehicle_out_date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#repair_invoice_date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#repair_payment_submission_date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#repair_payment_approval_date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#repair_submission_date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#repair_approval_date').datepicker({format: "dd-mm-yyyy", autoclose: true});

    jQuery('#getrepair_edit #repair_payment_submission_date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#getrepair_edit #repair_payment_approval_date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#getrepair_edit #repair_submission_date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#getrepair_edit #repair_approval_date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#getrepair_edit #repair_vehicle_in_date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#getrepair_edit #repair_vehicle_out_date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#getrepair_edit #repair_invoice_date').datepicker({format: "dd-mm-yyyy", autoclose: true});

    jQuery('#accessory_vehicle_in_date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#accessory_vehicle_out_date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#accessory_invoice_date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#accessory_payment_submission_date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#accessory_payment_approval_date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#accessory_submission_date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#accessory_approval_date').datepicker({format: "dd-mm-yyyy", autoclose: true});

    jQuery('#getaccessory_edit #accessory_payment_submission_date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#getaccessory_edit #accessory_payment_approval_date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#getaccessory_edit #accessory_submission_date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#getaccessory_edit #accessory_approval_date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#getaccessory_edit #accessory_vehicle_in_date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#getaccessory_edit #accessory_vehicle_out_date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#getaccessory_edit #accessory_invoice_date').datepicker({format: "dd-mm-yyyy", autoclose: true});

    jQuery('#acc_Date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#val_from_Date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#val_to_Date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#acc_submission_date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#acc_approval_date').datepicker({format: "dd-mm-yyyy", autoclose: true});

    jQuery('#editaccident_approval #acc_Date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#editaccident_approval #val_from_Date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#editaccident_approval #val_to_Date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#editaccident_approval #acc_submission_date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#editaccident_approval #acc_approval_date').datepicker({format: "dd-mm-yyyy", autoclose: true});
    jQuery('#emidate').datepicker({format: "dd-mm-yyyy", autoclose: true});

    //jQuery("#radio_show").hide();
    jQuery("#insurance1").click(function () {
        jQuery("#radio_show").show();
    });
    jQuery("#insurance2").click(function () {
        jQuery("#radio_show").hide();
    });

    //jQuery("#loan_show").hide();
    jQuery("#loan1").click(function () {
        jQuery("#loan_show").show();
    });
    jQuery("#loan2").click(function () {
        jQuery("#loan_show").hide();
    });
    
    jQuery("#amc1").click(function () {
        jQuery("#amc_show").show();
    });
    
    jQuery("#amc2").click(function () {
        jQuery("#amc_show").hide();
    });
    
    

    jQuery('#edit_tax_type').change(function () {
        if (this.value == '2')
        {
            jQuery('#edit_reg_name').show();
            jQuery('#edit_registrationno').show();
        }
        else
        {
            jQuery('#edit_reg_name').hide();
            jQuery('#edit_registrationno').hide();
        }
    });

    jQuery('#tax_type').change(function () {
        if (this.value == '2') {
            jQuery('#reg_name').show();
            jQuery('#registrationno').show();
        }
        else {
            jQuery('#reg_name').hide();
            jQuery('#registrationno').hide();
        }
    });

    mappedcheckpoints();
    mappedfences();

    //  Make The Form Readonly When flag == 1
    /*
     var veh_readonly = jQuery('#edit_veh_readonly').val();
     if(veh_readonly == 1)
     {
     jQuery('#sendapproval').hide();
     jQuery('#general input').attr('readonly', 'readonly');
     jQuery('#general select').attr('readonly', 'readonly');
     jQuery('#general textarea').attr('readonly', 'readonly');
     jQuery('#general input:button').hide();
     
     jQuery('#description input').attr('readonly', 'readonly');
     jQuery('#description select').attr('readonly', 'readonly');
     jQuery('#description textarea').attr('readonly', 'readonly');
     jQuery('#description input:button').hide();
     
     jQuery('#add_battery_new').hide();
     jQuery('#add_tyre_new').hide();
     jQuery('#add_repair_new').hide();
     jQuery('#add_acc_new').hide();
     jQuery('#add_accessory_new').hide();
     
     jQuery('#insurance_form input').attr('readonly', 'readonly');
     jQuery('#insurance_form select').attr('readonly', 'readonly');
     jQuery('#insurance_form textarea').attr('readonly', 'readonly');
     jQuery('#insurance_form input:button').hide();
     jQuery('#insurance_form input:radio').attr('disabled', 'disabled');
     
     jQuery('#capitalization_form input').attr('readonly', 'readonly');
     jQuery('#capitalization_form textarea').attr('readonly', 'readonly');
     jQuery('#capitalization_form input:button').hide();
     
     jQuery('#editpapers input').hide();
     jQuery('#editpapers textarea').attr('readonly', 'readonly');
     jQuery('#editpapers input:file').hide();
     jQuery('#editpapers input:button').hide();
     
     jQuery('#geo_form input').attr('readonly', 'readonly');
     jQuery('#geo_form select').attr('readonly', 'readonly');
     jQuery('#geo_form input:button').hide();
     jQuery('#uploadpaper').hide();
     }
     */
});
function addchk() {
    var checkpoint_id = jQuery('#chkid').val();

    if (checkpoint_id > -1 && jQuery('#to_checkpoint_div_' + checkpoint_id).val() == null) {
        var selected_name = jQuery('#chkid option:selected').text();
        var div = document.createElement('div');
        var remove_image = document.createElement('img');
        remove_image.src = "../../images/boxdelete.png";
        remove_image.className = 'clickimage';
        remove_image.onclick = function () {
            removeCheckpoint(checkpoint_id);
        };
        div.className = 'recipientbox';
        div.id = 'to_checkpoint_div_' + checkpoint_id;
        div.innerHTML = '<span>' + selected_name + '</span><input type="hidden" name="to_checkpoint_' + checkpoint_id + '" value="' + checkpoint_id + '"/>';
        jQuery('#checkpoint_list').append(div);
        jQuery(div).append(remove_image);
    }
    jQuery('#chkid').selectedIndex = 0;
}

function removeCheckpoint(checkpoint_no) {
    jQuery('#to_checkpoint_div_' + checkpoint_no).remove();
}

function addallchk() {

    jQuery("#chkid option").each(function (index, element) {
        jQuery("#chkid").val(jQuery(element).val());
        addchk()
    });
}

function kindtype() {
    var kind = jQuery("#kind").val();
    if (kind != 'Car'){
        jQuery(".kindcar").show();
    } else {
        jQuery(".kindcar").hide();
    }
}

function addfence() {
    var fence_id = jQuery('#fenceid').val();
    if (fence_id > -1 && jQuery('#to_fence_div_' + fence_id).val() == null) {
        var selected_name = jQuery('#fenceid option:selected').text();
        var div = document.createElement('div');
        var remove_image = document.createElement('img');
        remove_image.src = "../../images/boxdelete.png";
        remove_image.className = 'clickimage';
        remove_image.onclick = function () {
            removefence(fence_id);
        };
        div.className = 'recipientbox';
        div.id = 'to_fence_div_' + fence_id;
        div.innerHTML = '<span>' + selected_name + '</span><input type="hidden" name="to_fence_' + fence_id + '" value="' + fence_id + '"/>';
        jQuery('#fence_list').append(div);
        jQuery(div).append(remove_image);
    }
    jQuery('#fenceid').selectedIndex = 0;
}

function removefence(fenceid) {
    jQuery('#to_fence_div_' + fenceid).remove();
}

function addallfence() {

    jQuery("#fenceid option").each(function (index, element) {
        jQuery("#fenceid").val(jQuery(element).val());
        addfence();
    });

}

function isNumberKey(evt) {
    var charCode = (evt.which) ? evt.which : event.keyCode
    if (charCode > 31 && (charCode < 48 || charCode > 57))
        return false;
    return true;
}

function nospecialchars(evt) {
    var charCode = (evt.which) ? evt.which : event.keyCode
    if ((charCode > 32 && charCode < 44) || charCode == 64)
        return false;
    return true;
}


function editvehicles()
{
    var vehicle = 0;
    var description = 0;
    var insurance = 0;
    var cap = 0;
    var isChecked = jQuery("input[id=insurance1]:checked").val();
    var isLoan = jQuery("input[id=loan1]:checked").val();
    var cap_date = jQuery('#cap_EDate').val();

    if (jQuery("#edit_vehicle_id").val() == "")
    {
        jQuery("#vehicle_error").show();
        jQuery("#vehicle_error").fadeOut(6000);
    }
    else if (jQuery("#edit_vehicle_no").val().replace(/[^a-z]/g, "").length > 0 || jQuery("#edit_vehicle_no").val().replace(/[^0-9]/g, "").length == 0)
    {
        jQuery("#vehicle_input_error").show();
        jQuery("#vehicle_input_error").fadeOut(6000);
    }
    else if (jQuery("#yearofman").val() == "")
    {
        jQuery("#yearofman_error").show();
        jQuery("#yearofman_error").fadeOut(6000);
    }
    else if (jQuery("#yearofman").val() < 2000)
    {
        jQuery("#yearofman_2000_error").show();
        jQuery("#yearofman_2000_error").fadeOut(6000);
    }
    else if (jQuery("#PDate").val() == "")
    {
        jQuery("#PDate_error").show();
        jQuery("#PDate_error").fadeOut(6000);
    }
    else if (jQuery("#PDate").val() != "" && jQuery("#yearofman").val() != "")
    {
        var yom = jQuery("#yearofman").val();
        var purchase_date = jQuery("#PDate").val();
        var splitdate = purchase_date.split("-");
        var year = splitdate[2];
        if (yom <= year) {
            vehicle = 1;
            //alert(vehicle);
        }
        else {
            jQuery("#year_error").show();
            jQuery("#year_error").fadeOut(6000);
        }
    }
    //alert(vehicle);
    if (vehicle != '0' && jQuery("#branchid").val() == "" && jQuery("#cheirarchy").val() == '1')
    {
        jQuery("#branch_error").show();
        jQuery("#branch_error").fadeOut(6000);
    }
    else if (vehicle != '0' && jQuery("#start_meter").val().replace(/[^a-z]/g, "").length > 0 || jQuery("#start_meter").val().replace(/[^A-Z]/g, "").length > 0)
    {
        jQuery("#meter_error").show();
        jQuery("#meter_error").fadeOut(6000);
    }
    else if (vehicle != '0' && jQuery("#edit_engineno").val() == "")
    {
        jQuery("#engineno_comp_error").show();
        jQuery("#engineno_comp_error").fadeOut(6000);
    }
    else if (vehicle != '0' && jQuery("#chasisno").val() == "")
    {
        jQuery("#chasisno_comp_error").show();
        jQuery("#chasisno_comp_error").fadeOut(6000);
    }
    else if (vehicle != '0' && jQuery("#edit_engineno").val().replace(/[^a-z]/g, "").length > 0)
    {
        jQuery("#engineno_error").show();
        jQuery("#engineno_error").fadeOut(6000);
    }
    else if (vehicle != '0' && jQuery("#invoiceno").val() == "")
    {
        jQuery("#invoice_no_error").show();
        jQuery("#invoice_no_error").fadeOut(6000);
    }
    else if ((vehicle != '0' && jQuery("#chasisno").val() != '' && jQuery("#chasisno").val().replace(/[^a-z]/g, "").length > 0))
    {
        jQuery("#chasisno_error").show();
        jQuery("#chasisno_error").fadeOut(6000);
    }
    else if (vehicle != '0' && jQuery("#invoice_date").val() == "")
    {
        jQuery("#invoice_date_error").show();
        jQuery("#invoice_date_error").fadeOut(6000);
    }
    else if (vehicle != '0' && jQuery("#invoice_date").val() != "" && jQuery("#yearofman").val() != "")
    {
        //alert(validvehicle);
        var yom1 = jQuery("#yearofman").val();
        var invoice_date1 = jQuery("#invoice_date").val();
        var splitdate1 = invoice_date1.split("-");
        var year1 = splitdate1[2];
        if (yom1 <= year1) {
            description = 1;
            //alert(description);
        }
        else {
            jQuery("#invoice_year_error").show();
            jQuery("#invoice_year_error").fadeOut(6000);
        }
    }
    if (description != '0' && isChecked && jQuery("#insurance_value").val() == '')
    {
        jQuery("#value_empty_error").show();
        jQuery("#value_empty_error").fadeOut(6000);
    }
    else if (description != '0' && isChecked && jQuery("#premium_value").val() == '')
    {
        jQuery("#premium_empty_error").show();
        jQuery("#premium_empty_error").fadeOut(6000);
    }
    else if (description != '0' && isChecked && jQuery("#edit_insurance_company").val() == '')
    {
        jQuery("#company_error").show();
        jQuery("#company_error").fadeOut(6000);
    }
    else if ((description != '0' && isChecked && jQuery("#insurance_value").val() != '' && jQuery("#insurance_value").val().replace(/[^a-z]/g, "").length > 0) || (description != '0' && isChecked && jQuery("#insurance_value").val() != '' && jQuery("#insurance_value").val().replace(/[^A-Z]/g, "").length > 0))
    {
        jQuery("#insurance_value_error").show();
        jQuery("#insurance_value_error").fadeOut(6000);
    }
    else if ((description != '0' && isChecked && jQuery("#premium_value").val() != '' && jQuery("#premium_value").val().replace(/[^a-z]/g, "").length > 0) || (description != '0' && isChecked && jQuery("#premium_value").val() != '' && jQuery("#premium_value").val().replace(/[^A-Z]/g, "").length > 0))
    {
        jQuery("#premium_value_error").show();
        jQuery("#premium_value_error").fadeOut(6000);
    }
    else if (description != '0' && isChecked && jQuery("#StartDate").val() != "" && jQuery("#EndDate").val() != "")
    {
        var from_date = jQuery("#StartDate").val();
        var to_date = jQuery("#EndDate").val();
        var datediff = daydiff(parseDate(from_date), parseDate(to_date));
        if (datediff < 0) {
            jQuery("#date_conf_error").show();
            jQuery("#date_conf_error").fadeOut(6000);
        }
        else if (isChecked && jQuery("#yearofman").val() != "")
        {
            var yom = jQuery("#yearofman").val();
            var splitdate = from_date.split("-");
            var from_year = splitdate[2];
            var splitdate_to = to_date.split("-");
            var to_year = splitdate_to[2];
            if (yom <= from_year && yom <= to_year) {
                insurance = 1;

            }
            else {
                jQuery("#man_date_error").show();
                jQuery("#man_date_error").fadeOut(6000);
                insurance = 0;

            }
        }
    }
    else if (description != '0' && isLoan && jQuery("#margin_amt").val() == '') {
        jQuery("#margin_error").show();
        jQuery("#margin_error").fadeOut(6000);
    }
    else if (description != '0' && isLoan && jQuery("#loan_amt").val() == '') {
        jQuery("#loan_error").show();
        jQuery("#loan_error").fadeOut(6000);
    }
    else if (description != '0' && isLoan && jQuery("#emi_amt").val() == '') {
        jQuery("#emi_error").show();
        jQuery("#emi_error").fadeOut(6000);
    }
    else if (description != '0' && isLoan && jQuery("#loan_tenure").val() == '') {
        jQuery("#loantenure_error").show();
        jQuery("#loantenure_error").fadeOut(6000);
    }
    else if (description != '0' && isLoan && jQuery("#financier").val() == '') {
        jQuery("#financier_error").show();
        jQuery("#financier_error").fadeOut(6000);
    }
    else if (description != '0' && isLoan && jQuery("#StartDateloan").val() == '') {
        jQuery("#startloan_error").show();
        jQuery("#startloan_error").fadeOut(6000);
    }
    else if (description != '0' && isLoan && jQuery("#EndDateloan").val() == '') {
        jQuery("#endloan_error").show();
        jQuery("#endloan_error").fadeOut(6000);
    }
    else if (description != '0' && jQuery("#edit_cap_cost").val() == "" || description != '0' && jQuery("#edit_cap_cost").val() < 1)
    {
        jQuery("#cap_amount_error").show();
        jQuery("#cap_amount_error").fadeOut(6000);
    }
    else if (description != '0' && jQuery("#yearofman").val() != "")
    {
        var yom = jQuery("#yearofman").val();
        var splitdate = cap_date.split("-");
        var from_year = splitdate[2];
        if (yom <= from_year) {
            cap = 1;
        }
        else
        {
            jQuery("#cap_date_man_error").show();
            jQuery("#cap_date_man_error").fadeOut(6000);
            cap = 0;
        }
    }


    if (description != '0' && isChecked && insurance != '0' && jQuery("#edit_cap_cost").val() == "" || description != '0' && isChecked && insurance != '0' && jQuery("#edit_cap_cost").val() < 1)
    {
        jQuery("#cap_amount_error").show();
        jQuery("#cap_amount_error").fadeOut(6000);
    }
    else if (description != '0' && isChecked && insurance != '0' && jQuery("#yearofman").val() != "")
    {
        var yom = jQuery("#yearofman").val();
        var splitdate = cap_date.split("-");
        var from_year = splitdate[2];
        if (yom <= from_year) {
            cap = 1;
        }
        else
        {
            jQuery("#cap_date_man_error").show();
            jQuery("#cap_date_man_error").fadeOut(6000);
            cap = 0;
        }
    }


    var v = vehicle;
    var d = description;
    var c = cap;
    if (v == '1' && d == '1' && c == '1')
    {
        var edit_vehicle_id = jQuery('#edit_vehicle_id').val();

        var data = jQuery('#general').serialize() + '&edit_vehicle_id=' + edit_vehicle_id;
        jQuery.ajax({
            url: "route_ajax.php",
            type: 'POST',
            cache: false,
            data: data,
            success: function (statuscheck) {
                if (statuscheck == "notok") {
                }
                else if (statuscheck == "ok") {
                    jQuery("#general_complete").val('done');
                    jQuery("#general_success").show();
                    jQuery("#general_success").fadeOut(6000);
                    //alert("test");

                    jQuery('#save_vehicle').attr('disabled', 'disabled');
                    jQuery('#sendapproval').removeAttr('disabled');
                }
            }
        });
        return false;

    }



}


function editvehicles_trigon()
{


    var edit_vehicle_id = jQuery('#edit_vehicle_id').val();

    var data = jQuery('#general').serialize() + '&edit_vehicle_id=' + edit_vehicle_id;
    jQuery.ajax({
        url: "route_ajax.php",
        type: 'POST',
        cache: false,
        data: data,
        success: function (statuscheck) {
            if (statuscheck == "notok") {
            }
            else if (statuscheck == "ok") {
                jQuery("#general_complete").val('done');
                jQuery("#general_success").show();
                jQuery("#general_success").fadeOut(6000);
                //alert("test");

                jQuery('#save_vehicle').attr('disabled', 'disabled');
                jQuery('#sendapproval').removeAttr('disabled');
            }
        }
    });
    return false;



}


function send_approval() {
    var general = jQuery('#general_complete').val();
    if (general == 'done') {
        jQuery('#sendapproval').removeAttr('disabled');
    }
}



function adddescription()
{
    var vehicleid = jQuery('#vehicle_id').val();
    if (vehicleid != '') {
        var data = jQuery('#description').serialize() + '&vehicleid=' + vehicleid;
        jQuery.ajax({
            url: "route_ajax.php",
            type: 'POST',
            cache: false,
            data: data,
            success: function (statuscheck) {
                if (statuscheck == "notok") {
                }
                else if (statuscheck == "ok") {
                    jQuery("#desc_complete").val('done');
                    jQuery("#description_success").show();
                    jQuery("#description_success").fadeOut(6000);
                }
            }
        });
        return false;
    }
    else {
        alert('please fill up general details first!!');
    }

}

function editdescription()
{
    var edit_vehicle_id = jQuery('#edit_vehicle_id').val();
    var valid = 0;
    var vehicleid = jQuery('#vehicle_id').val();

    if (jQuery("#edit_engineno").val() == "")
    {
        jQuery("#engineno_comp_error").show();
        jQuery("#engineno_comp_error").fadeOut(6000);
    }
    else if (jQuery("#chasisno").val() == "")
    {
        jQuery("#chasisno_comp_error").show();
        jQuery("#chasisno_comp_error").fadeOut(6000);
    }
    else if (jQuery("#edit_engineno").val().replace(/[^a-z]/g, "").length > 0)
    {
        jQuery("#engineno_error").show();
        jQuery("#engineno_error").fadeOut(6000);

    }
    else if ((jQuery("#chasisno").val() != '' && jQuery("#chasisno").val().replace(/[^a-z]/g, "").length > 0))
    {
        jQuery("#chasisno_error").show();
        jQuery("#chasisno_error").fadeOut(6000);
    }
    else if (jQuery("#invoice_date").val() != "" && jQuery("#yearofman").val() != "")
    {
        var yom = jQuery("#yearofman").val();
        var invoice_date = jQuery("#invoice_date").val();
        var splitdate = invoice_date.split("-");
        var year = splitdate[2];
        if (yom <= year) {
            valid = 1;
        }
        else {
            jQuery("#invoice_year_error").show();
            jQuery("#invoice_year_error").fadeOut(6000);
        }
    }
    if (valid == 1) {
        var data = jQuery('#description').serialize() + '&edit_vehicle_id=' + edit_vehicle_id;
        jQuery.ajax({
            url: "route_ajax.php",
            type: 'POST',
            cache: false,
            data: data,
            success: function (statuscheck) {
                if (statuscheck == "notok") {
                }
                else if (statuscheck == "ok") {
                    jQuery("#desc_complete").val('done');
                    jQuery("#description_success").show();
                    jQuery("#description_success").fadeOut(6000);
                }
            }
        });
        return false;
    }
}

function getmodel()
{
    if (jQuery("#make").val() == "")
    {
        jQuery("#make_error").show();
        jQuery("#make_error").fadeOut(6000);
    }
    else
    {
        var makeid = jQuery('#make').val();
        jQuery.ajax({
            url: "route_ajax.php",
            type: 'POST',
            cache: false,
            data: {makeid: makeid},
            dataType: 'html',
            success: function (html) {
                jQuery("#model").html('<option value="">Select Model</option>');
                jQuery("#model").append(html);
            }
        });
        return false;

    }
}

function showbranch()
{
    if (jQuery("#branchid").val() == "")
    {
        jQuery("#branch_error").show();
        jQuery("#branch_error").fadeOut(6000);
        jQuery("#branch_div").html('');
    }
    else
    {
        var branchid = jQuery('#branchid').val();
        jQuery.ajax({
            url: "route_ajax.php",
            type: 'POST',
            cache: false,
            data: {branchdata: branchid},
            dataType: 'html',
            success: function (html) {
                jQuery("#branch_div").html('');
                jQuery("#branch_div").append(html);
            }
        });
        return false;

    }
}

function showdealer()
{
    if (jQuery("#dealerid").val() == "")
    {
        jQuery("#dealer_error").show();
        jQuery("#dealer_error").fadeOut(6000);
        jQuery("#code_dealer").val('');
    }
    else
    {
        var dealerid = jQuery('#dealerid').val();
        jQuery.ajax({
            url: "route_ajax.php",
            type: 'POST',
            cache: false,
            data: {dealerdata: dealerid},
            dataType: 'html',
            success: function (html) {
                jQuery("#code_dealer").val('');
                jQuery("#code_dealer").val(html);
            }
        });
        return false;

    }
}

function parseDate(str) {
    var mdy = str.split('-')
    return new Date(mdy[2], mdy[1], mdy[0] - 1);
}

function daydiff(first, second) {
    return (second - first) / (1000 * 60 * 60 * 24)
}

function addtax()
{
    var valid = 0;
    var vehicleid = jQuery('#edit_vehicle_id').val();
    if (jQuery("#tax_amount").val() == '')
    {
        jQuery("#tax_amount_comp_error").show();
        jQuery("#tax_amount_comp_error").fadeOut(6000);
    }
    else if (jQuery("#tax_type").val() == '')
    {
        jQuery("#tax_type_error").show();
        jQuery("#tax_type_error").fadeOut(6000);
    }
    else if (jQuery("#registrationno").val() == '' && jQuery("#tax_type").val() == 2)
    {
        jQuery("#registrationno_comp_error").show();
        jQuery("#registrationno_comp_error").fadeOut(6000);
    }
    else if ((jQuery("#tax_amount").val().replace(/[^a-z]/g, "").length > 0) || (jQuery("#tax_amount").val() != '' && jQuery("#tax_amount").val().replace(/[^A-Z]/g, "").length > 0) || (jQuery("#tax_amount").val() != '' && jQuery("#tax_amount").val().length > 7))
    {
        jQuery("#tax_amount_error").show();
        jQuery("#tax_amount_error").fadeOut(6000);
    }
    else if (jQuery("#registrationno").val().replace(/[^a-z]/g, "").length > 0)
    {
        jQuery("#registrationno_error").show();
        jQuery("#registrationno_error").fadeOut(6000);
    }
    else if (jQuery("#from_date").val() != "" && jQuery("#to_date").val() != "")
    {
        var from_date = jQuery("#from_date").val();
        var to_date = jQuery("#to_date").val();
        var datediff = daydiff(parseDate(from_date), parseDate(to_date));
        if (datediff < 0) {
            jQuery("#tax_datediff_error").show();
            jQuery("#tax_datediff_error").fadeOut(6000);
        }
        else {
            if (jQuery("#yearofman").val() != "")
            {
                var yom = jQuery("#yearofman").val();
                var splitdate = from_date.split("-");
                var from_year = splitdate[2];
                var splitdate_to = to_date.split("-");
                var to_year = splitdate_to[2];
                if (yom <= from_year && yom <= to_year) {
                    valid = 1;
                }
                else {
                    jQuery("#tax_year_error").show();
                    jQuery("#tax_year_error").fadeOut(6000);
                    valid = 0;
                }
            }
            if (vehicleid != '' && valid == 1) {
                var data = jQuery('#add_tax').serialize() + '&vehicleid=' + vehicleid;
                jQuery.ajax({
                    url: "route_ajax.php",
                    type: 'POST',
                    cache: false,
                    data: data,
                    success: function (statuscheck) {
                        if (statuscheck == "notok") {
                        }
                        else if (statuscheck == "ok") {
                            jQuery("#tax_complete").val('done');
                            jQuery('#addtax').modal('hide');
                            gettax();
                            jQuery('#add_tax')[0].reset();
                            jQuery("#tax_success").show();
                            jQuery("#tax_success").fadeOut(6000);
                        }
                    }
                });
                return false;
            }
            else if (vehicleid == '') {
                alert('please fill up general details first!!');
            }
        }
    }

}

function editinsurance(vehicleid) {
    var valid = 0;
    var isChecked = jQuery("input[id=insurance1]:checked").val();
    if (isChecked)
    {
        if (jQuery("#insurance_value").val() == '')
        {
            jQuery("#value_empty_error").show();
            jQuery("#value_empty_error").fadeOut(6000);
        }
        else if (jQuery("#premium_value").val() == '')
        {
            jQuery("#premium_empty_error").show();
            jQuery("#premium_empty_error").fadeOut(6000);
        }
        else if (jQuery("#insurance_company").val() == '')
        {
            jQuery("#company_error").show();
            jQuery("#company_error").fadeOut(6000);
        }
        else if ((jQuery("#insurance_value").val() != '' && jQuery("#insurance_value").val().replace(/[^a-z]/g, "").length > 0) || (jQuery("#insurance_value").val() != '' && jQuery("#insurance_value").val().replace(/[^A-Z]/g, "").length > 0))
        {
            jQuery("#insurance_value_error").show();
            jQuery("#insurance_value_error").fadeOut(6000);
        }
        else if ((jQuery("#premium_value").val() != '' && jQuery("#premium_value").val().replace(/[^a-z]/g, "").length > 0) || (jQuery("#premium_value").val() != '' && jQuery("#premium_value").val().replace(/[^A-Z]/g, "").length > 0))
        {
            jQuery("#premium_value_error").show();
            jQuery("#premium_value_error").fadeOut(6000);
        }
        else if (jQuery("#StartDate").val() != "" && jQuery("#EndDate").val() != "")
        {
            var from_date = jQuery("#StartDate").val();
            var to_date = jQuery("#EndDate").val();
            var datediff = daydiff(parseDate(from_date), parseDate(to_date));
            if (datediff < 0) {
                jQuery("#date_conf_error").show();
                jQuery("#date_conf_error").fadeOut(6000);
            }
            else {
                if (jQuery("#yearofman").val() != "")
                {
                    var yom = jQuery("#yearofman").val();
                    var splitdate = from_date.split("-");
                    var from_year = splitdate[2];
                    var splitdate_to = to_date.split("-");
                    var to_year = splitdate_to[2];
                    if (yom <= from_year && yom <= to_year) {
                        valid = 1;
                    }
                    else {
                        jQuery("#man_date_error").show();
                        jQuery("#man_date_error").fadeOut(6000);
                        valid = 0;
                    }
                }

                if (vehicleid != '' && isChecked && valid == 1) {
                    var data = jQuery('#insurance_form').serialize() + '&vehicleid=' + vehicleid;
                    jQuery.ajax({
                        url: "route_ajax.php",
                        type: 'POST',
                        cache: false,
                        data: data,
                        success: function (statuscheck) {
                            if (statuscheck == "notok") {
                            }
                            else if (statuscheck == "ok") {
                                jQuery("#insurance_complete").val('done');
                                jQuery("#insurance_success").show();
                                jQuery("#insurance_success").fadeOut(6000);
                            }
                        }
                    });
                    return false;
                }
                else if (vehicleid != '' && !isChecked) {
                    jQuery("#insurance_success").show();
                    jQuery("#insurance_success").fadeOut(6000);
                    jQuery("#insurance_complete").val('done');
                }
            }
        }
    }
    else
    {
        jQuery("#insurance_success").show();
        jQuery("#insurance_success").fadeOut(6000);
        jQuery("#insurance_complete").val('done');
    }
}

function addinsurance()
{
    var vehicleid = jQuery('#vehicle_id').val();
    var isChecked = jQuery("input[id=insurance1]:checked").val();
    if (vehicleid != '' && isChecked) {
        var data = jQuery('#insurance_form').serialize() + '&vehicleid=' + vehicleid;
        jQuery.ajax({
            url: "route_ajax.php",
            type: 'POST',
            cache: false,
            data: data,
            success: function (statuscheck) {
                if (statuscheck == "notok") {
                }
                else if (statuscheck == "ok") {
                    jQuery("#insurance_complete").val('done');
                    jQuery("#insurance_success").show();
                    jQuery("#insurance_success").fadeOut(6000);
                }
            }
        });
        return false;
    }
    else if (vehicleid != '') {
        jQuery("#insurance_success").show();
        jQuery("#insurance_success").fadeOut(6000);
        jQuery("#insurance_complete").val('done');
    }
    else {
        alert('please fill up general details first!!');
    }

}


function addcap()
{
    var vehicleid = jQuery('#vehicle_id').val();
    if (vehicleid != '') {
        var data = jQuery('#capitalization_form').serialize() + '&vehicleid=' + vehicleid;
        jQuery.ajax({
            url: "route_ajax.php",
            type: 'POST',
            cache: false,
            data: data,
            success: function (statuscheck) {
                if (statuscheck == "notok") {
                }
                else if (statuscheck == "ok") {
                    jQuery("#capitalization_complete").val('done');
                    jQuery("#capitalization_success").show();
                    jQuery("#capitalization_success").fadeOut(6000);
                    jQuery("#capitalization_complete").val('done');
                }
            }
        });
        return false;
    }
    else {
        alert('please fill up general details first!!');
    }

}

function editcap(vehicleid) {
    var valid = 0;
    var cap_date = jQuery('#cap_EDate').val();
    if (jQuery("#edit_cap_cost").val() == "" || jQuery("#edit_cap_cost").val() < 1)
    {
        jQuery("#cap_amount_error").show();
        jQuery("#cap_amount_error").fadeOut(6000);
    }
    else if (jQuery("#yearofman").val() != "")
    {
        var yom = jQuery("#yearofman").val();
        var splitdate = cap_date.split("-");
        var from_year = splitdate[2];
        if (yom <= from_year) {
            valid = 1;
        }
        else
        {
            jQuery("#cap_date_man_error").show();
            jQuery("#cap_date_man_error").fadeOut(6000);
            valid = 0;
        }
    }
    if (vehicleid != '') {
        if (valid == 1)
        {
            var data = jQuery('#capitalization_form').serialize() + '&vehicleid=' + vehicleid;
            jQuery.ajax({
                url: "route_ajax.php",
                type: 'POST',
                cache: false,
                data: data,
                success: function (statuscheck) {
                    if (statuscheck == "notok") {
                    }
                    else if (statuscheck == "ok") {
                        jQuery("#capitalization_complete").val('done');
                        jQuery("#capitalization_success").show();
                        jQuery("#capitalization_success").fadeOut(6000);
                        jQuery("#capitalization_complete").val('done');
                    }
                }
            });
            return false;
        }
    }
    else {
        alert('please fill up general details first!!');
    }
}

function editgeo()
{
    var vehicleid = jQuery('#edit_vehicle_id').val();
    if (vehicleid != '') {
        var data = jQuery('#general').serialize() + '&editgeo_vehicleid=' + vehicleid;
        jQuery.ajax({
            url: "route_ajax.php",
            type: 'POST',
            cache: false,
            data: data,
            success: function (statuscheck) {
                if (statuscheck == "notok") {
                }
                else if (statuscheck == "ok") {
                    jQuery("#geo_complete").val('done');
                    jQuery("#geo_success").show();
                    jQuery("#geo_success").fadeOut(6000);
                }
            }
        });
        return false;
    }
    else {
        alert('please fill up general details first!!');
    }

}

function addbattery_history()
{
    var vehicleid = jQuery('#edit_vehicle_id').val();
    var meter_reading = jQuery("#addbattery #batt_meter_reading").val();
    var dealerid = jQuery("#addbattery #batt_dealerid option:selected").val();
    var note = jQuery("#addbattery #note_batt").val();
    var vehicle_in_date = jQuery("#addbattery #batt_vehicle_in_date").val();
    var vehicle_out_date = jQuery("#addbattery #batt_vehicle_out_date").val();
    var vehicle_alert = jQuery("#addbattery #batt_alert_by_email").val();
    var amount_quote = jQuery("#addbattery #batt_amount_quote").val();
    var invoice_no = jQuery("#addbattery #batt_invoice_no").val();
    var amount_invoice = jQuery("#addbattery #batt_amount_invoice").val();
    var ofasnumber = jQuery("#addbattery #batt_ofasnumber").val();
    var datediff = daydiff(parseDate(vehicle_in_date), parseDate(vehicle_out_date));

    if (meter_reading == "")
    {
        jQuery("#addbattery #mr_error").show();
        jQuery("#addbattery #mr_error").fadeOut(6000);
    }
    else if (dealerid == '-1')
    {
        jQuery("#addbattery #dn_error").show();
        jQuery("#addbattery #dn_error").fadeOut(6000);
    }
    else if (note == "")
    {
        jQuery("#addbattery #notes_error").show();
        jQuery("#addbattery #notes_error").fadeOut(6000);
    }
    else if (amount_quote == "")
    {
        jQuery("#addbattery #qa_error").show();
        jQuery("#addbattery #qa_error").fadeOut(6000);
    }
    else if (invoice_no == "")
    {
        jQuery("#addbattery #in_error").show();
        jQuery("#addbattery #in_error").fadeOut(6000);
    }
    else if (amount_invoice == "")
    {
        jQuery("#addbattery #ia_error").show();
        jQuery("#addbattery #ia_error").fadeOut(6000);
    }
    else if (datediff < 0)
    {
        jQuery("#addbattery #datediff_error").show();
        jQuery("#addbattery #datediff_error").fadeOut(6000);
    }
    else if (ofasnumber == "")
    {
        jQuery("#addbattery #ofas_error").show();
        jQuery("#addbattery #ofas_error").fadeOut(6000);
    }
    else if (amount_invoice > amount_quote)
    {
        jQuery("#addbattery #ia_q_error").show();
        jQuery("#addbattery #ia_q_error").fadeOut(6000);
    }
    else if (vehicleid != '') {
        var data = jQuery('#getbattery').serialize() + '&new_batt_vehicleid=' + vehicleid;
        jQuery.ajax({
            url: "route_ajax.php",
            type: 'POST',
            cache: false,
            data: data,
            success: function (statuscheck) {
                if (statuscheck == "notok") {
                }
                else if (statuscheck == "ok") {
                    document.getElementById("getbattery").reset();
                    jQuery('#addbattery').modal('hide');
                    jQuery("#maintenance_complete").val('done');
                    getbattery();
                    jQuery('#getbattary')[0].reset();
                }
            }
        });
        return false;
    }
    else {
        alert('please fill up general details first!!');
    }
}

function addtyre_history()
{
    var vehicleid = jQuery('#edit_vehicle_id').val();
    var meter_reading = jQuery("#addtyre #tyre_meter_reading").val();
    var dealerid = jQuery("#addtyre #tyre_dealerid option:selected").val();
    var note = jQuery("#addtyre #note_tyre").val();
    var vehicle_in_date = jQuery("#addtyre #tyre_vehicle_in_date").val();
    var vehicle_out_date = jQuery("#addtyre #tyre_vehicle_out_date").val();
    var amount_quote = jQuery("#addtyre #tyre_amount_quote").val();
    var invoice_no = jQuery("#addtyre #tyre_invoice_no").val();
    var amount_invoice = jQuery("#addtyre #tyre_amount_invoice").val();
    var ofasnumber = jQuery("#addtyre #tyre_ofasnumber").val();
    var datediff = daydiff(parseDate(vehicle_in_date), parseDate(vehicle_out_date));

    var tyre_list = [];
    jQuery('.tyre_type_array').each(function (id, obj) {
        tyre_list.push(obj.value);
    });

    if (meter_reading == "")
    {
        jQuery("#addtyre #mr_error").show();
        jQuery("#addtyre #mr_error").fadeOut(6000);
    }
    else if (dealerid == '-1')
    {
        jQuery("#addtyre #dn_error").show();
        jQuery("#addtyre #dn_error").fadeOut(6000);
    }
    else if (note == "")
    {
        jQuery("#addtyre #notes_error").show();
        jQuery("#addtyre #notes_error").fadeOut(6000);
    }
    else if (amount_quote == "")
    {
        jQuery("#addtyre #qa_error").show();
        jQuery("#addtyre #qa_error").fadeOut(6000);
    }
    else if (invoice_no == "")
    {
        jQuery("#addtyre #in_error").show();
        jQuery("#addtyre #in_error").fadeOut(6000);
    }
    else if (amount_invoice == "")
    {
        jQuery("#addtyre #ia_error").show();
        jQuery("#addtyre #ia_error").fadeOut(6000);
    }
    else if (datediff < 0)
    {
        jQuery("#addtyre #datediff_error").show();
        jQuery("#addtyre #datediff_error").fadeOut(6000);
    }
    else if (ofasnumber == "")
    {
        jQuery("#addtyre #ofas_error").show();
        jQuery("#addtyre #ofas_error").fadeOut(6000);
    }
    else if (amount_invoice > amount_quote)
    {
        jQuery("#addtyre #ia_q_error").show();
        jQuery("#addtyre #ia_q_error").fadeOut(6000);
    }
    else if (tyre_list.length == 0)
    {
        jQuery("#addtyre #tyre_type_error").show();
        jQuery("#addtyre #tyre_type_error").fadeOut(6000);
    }
    else if (vehicleid != '') {
        var tyrelist = "&tyre_list=" + tyre_list.toString() + "";

        var data = jQuery('#gettyre').serialize() + '&new_tyre_vehicleid=' + vehicleid + tyrelist;
        jQuery.ajax({
            url: "route_ajax.php",
            type: 'POST',
            cache: false,
            data: data,
            success: function (statuscheck) {
                if (statuscheck == "notok") {
                }
                else if (statuscheck == "ok") {
                    document.getElementById("gettyre").reset();
                    jQuery('#addtyre').modal('hide');
                    jQuery("#maintenance_complete").val('done');
                    gettyre();
                    jQuery('#gettyre')[0].reset();
                }
            }
        });
        return false;
    }
    else {
        alert('please fill up general details first!!');
    }
}

function addrepair_history()
{
    var vehicleid = jQuery('#edit_vehicle_id').val();
    var meter_reading = jQuery("#addrepair #repair_meter_reading").val();
    var dealerid = jQuery("#addrepair #repair_dealerid option:selected").val();
    var note = jQuery("#addrepair #note_repair").val();
    var tax = jQuery("#addrepair #p_tax").val();
    var vehicle_in_date = jQuery("#addrepair #repair_vehicle_in_date").val();
    var vehicle_out_date = jQuery("#addrepair #repair_vehicle_out_date").val();
    var amount_quote = jQuery("#addrepair #repair_amount_quote").val();
    var invoice_no = jQuery("#addrepair #repair_invoice_no").val();
    var amount_invoice = jQuery("#addrepair #repair_amount_invoice").val();
    var ofasnumber = jQuery("#addrepair #repair_ofasnumber").val();
    var datediff = daydiff(parseDate(vehicle_in_date), parseDate(vehicle_out_date));

    var category_type = jQuery('#category_type').val();

    var parts_list = [];
    jQuery('.parts_select_array').each(function (id, obj) {
        parts_list.push(obj.value);
    });
    // convering array into strin and assigning to the getstring url
    var partlist = "&parts_list=" + parts_list.toString() + "";
    var task_select_array = [];
    jQuery('.task_select_array').each(function (id, obj) {
        task_select_array.push(obj.value);
    });
    //var tasklist = "&task_list="+task_select_array.toString()+"";
    var get_string;
    var parts_list1 = [];
    var parts_total = 0;
    var tasks_total = 0;
    if (jQuery("#parts_select_1").val() != "-1")
    {
        parts_list1.push(jQuery("#parts_select_1").val() + "-" + jQuery("#parts_amount1").val() + "-" + jQuery("#parts_qty1").val());
        parts_total += jQuery("#parts_amount1").val() * jQuery("#parts_qty1").val();
    }
    if (jQuery("#parts_select_2").val() != "-1")
    {
        parts_list1.push(jQuery("#parts_select_2").val() + "-" + jQuery("#parts_amount2").val() + "-" + jQuery("#parts_qty2").val());
        parts_total += jQuery("#parts_amount2").val() * jQuery("#parts_qty2").val();
    }
    if (jQuery("#parts_select_3").val() != "-1")
    {
        parts_list1.push(jQuery("#parts_select_3").val() + "-" + jQuery("#parts_amount3").val() + "-" + jQuery("#parts_qty3").val());
        parts_total += jQuery("#parts_amount3").val() * jQuery("#parts_qty3").val();
    }
    if (jQuery("#parts_select_4").val() != "-1")
    {
        parts_list1.push(jQuery("#parts_select_4").val() + "-" + jQuery("#parts_amount4").val() + "-" + jQuery("#parts_qty4").val());
        parts_total += jQuery("#parts_amount4").val() * jQuery("#parts_qty4").val();
    }
    if (jQuery("#parts_select_5").val() != "-1")
    {
        parts_list1.push(jQuery("#parts_select_5").val() + "-" + jQuery("#parts_amount5").val() + "-" + jQuery("#parts_qty5").val());
        parts_total += jQuery("#parts_amount5").val() * jQuery("#parts_qty5").val();
    }
    if (jQuery("#parts_select_6").val() != "-1")
    {
        parts_list1.push(jQuery("#parts_select_6").val() + "-" + jQuery("#parts_amount6").val() + "-" + jQuery("#parts_qty6").val());
        parts_total += jQuery("#parts_amount6").val() * jQuery("#parts_qty6").val();
    }
    if (jQuery("#parts_select_7").val() != "-1")
    {
        parts_list1.push(jQuery("#parts_select_7").val() + "-" + jQuery("#parts_amount7").val() + "-" + jQuery("#parts_qty7").val());
        parts_total += jQuery("#parts_amount7").val() * jQuery("#parts_qty7").val();
    }
    if (jQuery("#parts_select_8").val() != "-1")
    {
        parts_list1.push(jQuery("#parts_select_8").val() + "-" + jQuery("#parts_amount8").val() + "-" + jQuery("#parts_qty8").val());
        parts_total += jQuery("#parts_amount8").val() * jQuery("#parts_qty8").val();
    }
    if (jQuery("#parts_select_9").val() != "-1")
    {
        parts_list1.push(jQuery("#parts_select_9").val() + "-" + jQuery("#parts_amount9").val() + "-" + jQuery("#parts_qty9").val());
        parts_total += jQuery("#parts_amount9").val() * jQuery("#parts_qty9").val();
    }
    if (jQuery("#parts_select_10").val() != "-1")
    {
        parts_list1.push(jQuery("#parts_select_10").val() + "-" + jQuery("#parts_amount10").val() + "-" + jQuery("#parts_qty10").val());
        parts_total += jQuery("#parts_amount10").val() * jQuery("#parts_qty10").val();
    }
    if (jQuery("#parts_select_11").val() != "-1")
    {
        parts_list1.push(jQuery("#parts_select_11").val() + "-" + jQuery("#parts_amount11").val() + "-" + jQuery("#parts_qty11").val());
        parts_total += jQuery("#parts_amount11").val() * jQuery("#parts_qty11").val();
    }
    if (jQuery("#parts_select_12").val() != "-1")
    {
        parts_list1.push(jQuery("#parts_select_12").val() + "-" + jQuery("#parts_amount12").val() + "-" + jQuery("#parts_qty12").val());
        parts_total += jQuery("#parts_amount12").val() * jQuery("#parts_qty12").val();
    }
    if (jQuery("#parts_select_13").val() != "-1")
    {
        parts_list1.push(jQuery("#parts_select_13").val() + "-" + jQuery("#parts_amount13").val() + "-" + jQuery("#parts_qty13").val());
        parts_total += jQuery("#parts_amount13").val() * jQuery("#parts_qty13").val();
    }
    if (jQuery("#parts_select_14").val() != "-1")
    {
        parts_list1.push(jQuery("#parts_select_14").val() + "-" + jQuery("#parts_amount14").val() + "-" + jQuery("#parts_qty14").val());
        parts_total += jQuery("#parts_amount14").val() * jQuery("#parts_qty14").val();
    }
    if (jQuery("#parts_select_15").val() != "-1")
    {
        parts_list1.push(jQuery("#parts_select_15").val() + "-" + jQuery("#parts_amount15").val() + "-" + jQuery("#parts_qty15").val());
        parts_total += jQuery("#parts_amount15").val() * jQuery("#parts_qty15").val();
    }

    get_string += "&parts_select_array1=" + parts_list1.toString() + "";

    var tasks_list1 = [];
    if (jQuery("#tasks_select_1").val() != "-1")
    {
        tasks_list1.push(jQuery("#tasks_select_1").val() + "-" + jQuery("#tasks_amount1").val() + "-" + jQuery("#tasks_qty1").val());
        tasks_total += jQuery("#tasks_amount1").val() * jQuery("#tasks_qty1").val();
    }
    if (jQuery("#tasks_select_2").val() != "-1")
    {
        tasks_list1.push(jQuery("#tasks_select_2").val() + "-" + jQuery("#tasks_amount2").val() + "-" + jQuery("#tasks_qty2").val());
        tasks_total += jQuery("#tasks_amount2").val() * jQuery("#tasks_qty2").val();
    }
    if (jQuery("#tasks_select_3").val() != "-1")
    {
        tasks_list1.push(jQuery("#tasks_select_3").val() + "-" + jQuery("#tasks_amount3").val() + "-" + jQuery("#tasks_qty3").val());
        tasks_total += jQuery("#tasks_amount3").val() * jQuery("#tasks_qty3").val();
    }
    if (jQuery("#tasks_select_4").val() != "-1")
    {
        tasks_list1.push(jQuery("#tasks_select_4").val() + "-" + jQuery("#tasks_amount4").val() + "-" + jQuery("#tasks_qty4").val());
        tasks_total += jQuery("#tasks_amount4").val() * jQuery("#tasks_qty4").val();
    }
    if (jQuery("#tasks_select_5").val() != "-1")
    {
        tasks_list1.push(jQuery("#tasks_select_5").val() + "-" + jQuery("#tasks_amount5").val() + "-" + jQuery("#tasks_qty5").val());
        tasks_total += jQuery("#tasks_amount5").val() * jQuery("#tasks_qty5").val();
    }
    if (jQuery("#tasks_select_6").val() != "-1")
    {
        tasks_list1.push(jQuery("#tasks_select_6").val() + "-" + jQuery("#tasks_amount6").val() + "-" + jQuery("#tasks_qty6").val());
        tasks_total += jQuery("#tasks_amount6").val() * jQuery("#tasks_qty6").val();
    }
    if (jQuery("#tasks_select_7").val() != "-1")
    {
        tasks_list1.push(jQuery("#tasks_select_7").val() + "-" + jQuery("#tasks_amount7").val() + "-" + jQuery("#tasks_qty7").val());
        tasks_total += jQuery("#tasks_amount7").val() * jQuery("#tasks_qty7").val();
    }
    if (jQuery("#tasks_select_8").val() != "-1")
    {
        tasks_list1.push(jQuery("#tasks_select_8").val() + "-" + jQuery("#tasks_amount8").val() + "-" + jQuery("#tasks_qty8").val());
        tasks_total += jQuery("#tasks_amount8").val() * jQuery("#tasks_qty8").val();
    }
    if (jQuery("#tasks_select_9").val() != "-1")
    {
        tasks_list1.push(jQuery("#tasks_select_9").val() + "-" + jQuery("#tasks_amount9").val() + "-" + jQuery("#tasks_qty9").val());
        tasks_total += jQuery("#tasks_amount9").val() * jQuery("#tasks_qty9").val();
    }
    if (jQuery("#tasks_select_10").val() != "-1")
    {
        tasks_list1.push(jQuery("#tasks_select_10").val() + "-" + jQuery("#tasks_amount10").val() + "-" + jQuery("#tasks_qty10").val());
        tasks_total += jQuery("#tasks_amount10").val() * jQuery("#tasks_qty10").val();
    }
    if (jQuery("#tasks_select_11").val() != "-1")
    {
        tasks_list1.push(jQuery("#tasks_select_11").val() + "-" + jQuery("#tasks_amount11").val() + "-" + jQuery("#tasks_qty11").val());
        tasks_total += jQuery("#tasks_amount11").val() * jQuery("#tasks_qty11").val();
    }
    if (jQuery("#tasks_select_12").val() != "-1")
    {
        tasks_list1.push(jQuery("#tasks_select_12").val() + "-" + jQuery("#tasks_amount12").val() + "-" + jQuery("#tasks_qty12").val());
        tasks_total += jQuery("#tasks_amount12").val() * jQuery("#tasks_qty12").val();
    }
    if (jQuery("#tasks_select_13").val() != "-1")
    {
        tasks_list1.push(jQuery("#tasks_select_13").val() + "-" + jQuery("#tasks_amount13").val() + "-" + jQuery("#tasks_qty13").val());
        tasks_total += jQuery("#tasks_amount13").val() * jQuery("#tasks_qty13").val();
    }
    if (jQuery("#tasks_select_14").val() != "-1")
    {
        tasks_list1.push(jQuery("#tasks_select_14").val() + "-" + jQuery("#tasks_amount14").val() + "-" + jQuery("#tasks_qty14").val());
        tasks_total += jQuery("#tasks_amount14").val() * jQuery("#tasks_qty14").val();
    }
    if (jQuery("#tasks_select_15").val() != "-1")
    {
        tasks_list1.push(jQuery("#tasks_select_15").val() + "-" + jQuery("#tasks_amount15").val() + "-" + jQuery("#tasks_qty15").val());
        tasks_total += jQuery("#tasks_amount15").val() * jQuery("#tasks_qty15").val();
    }
    get_string += "&tasks_select_array1=" + tasks_list1.toString() + "";
    var tot = parts_total + parseInt(tasks_total);
    get_string += "&totalinv=" + tot + "+&tax=" + tax + "";

    if (meter_reading == "")
    {
        jQuery("#addrepair #mr_error").show();
        jQuery("#addrepair #mr_error").fadeOut(6000);
    }
    else if (dealerid == '-1')
    {
        jQuery("#addrepair #dn_error").show();
        jQuery("#addrepair #dn_error").fadeOut(6000);
    }
    else if (note == "")
    {
        jQuery("#addrepair #notes_error").show();
        jQuery("#addrepair #notes_error").fadeOut(6000);
    }
    else if (amount_quote == "")
    {
        jQuery("#addrepair #qa_error").show();
        jQuery("#addrepair #qa_error").fadeOut(6000);
    }
    else if (invoice_no == "")
    {
        jQuery("#addrepair #in_error").show();
        jQuery("#addrepair #in_error").fadeOut(6000);
    }
    else if (amount_invoice == "")
    {
        jQuery("#addrepair #ia_error").show();
        jQuery("#addrepair #ia_error").fadeOut(6000);
    }
    else if (datediff < 0)
    {
        jQuery("#addrepair #datediff_error").show();
        jQuery("#addrepair #datediff_error").fadeOut(6000);
    }
    else if (ofasnumber == "")
    {
        jQuery("#addrepair #ofas_error").show();
        jQuery("#addrepair #ofas_error").fadeOut(6000);
    }
    else if (amount_invoice > amount_quote)
    {
        jQuery("#addrepair #ia_q_error").show();
        jQuery("#addrepair #ia_q_error").fadeOut(6000);
    }

    /**
     else if(category_type == -1)
     {
     jQuery("#addrepair #parts_tasks_error").show();
     jQuery("#addrepair #parts_tasks_error").fadeOut(6000);            
     }
     else if(category_type == 2 && (parts_list.length == 0 && task_select_array.length == 0))
     {
     jQuery("#addrepair #parts_tasks_error").show();
     jQuery("#addrepair #parts_tasks_error").fadeOut(6000);        
     }
     
     **/
    else if (vehicleid != '') {

        if (jQuery('#addrepair #category_type').val() == '2') {
            var tasklist = "&task_select_array=" + task_select_array.toString() + "";
            var data = jQuery('#getrepair').serialize() + partlist + tasklist + '&new_repair_vehicleid=' + vehicleid + '&get_string=' + get_string;
        }
        else {
            var data = jQuery('#getrepair').serialize() + partlist + tasklist + '&new_repair_vehicleid=' + vehicleid + '&get_string=' + get_string;
        }
        jQuery.ajax({
            url: "route_ajax.php",
            type: 'POST',
            cache: false,
            data: data,
            success: function (statuscheck) {
                if (statuscheck == "notok") {
                }
                else if (statuscheck == "ok") {
                    jQuery('#addrepair').modal('hide');
                    jQuery("#maintenance_complete").val('done');
                    getrepair();
                    jQuery('#getrepair')[0].reset();
                }
            }
        });
        return false;
    }
    else {
        alert('please fill up general details first!!');
    }
}

function addaccessory_history()
{
    var vehicleid = jQuery('#edit_vehicle_id').val();
    var meter_reading = jQuery("#addaccessory #accessory_meter_reading").val();
    var dealerid = jQuery("#addaccessory #accessory_dealerid option:selected").val();
    var note = jQuery("#addaccessory #note_accessory").val();
    var vehicle_in_date = jQuery("#addaccessory #accessory_vehicle_in_date").val();
    var vehicle_out_date = jQuery("#addaccessory #accessory_vehicle_out_date").val();
    var amount_quote = jQuery("#addaccessory #accessory_amount_quote").val();
    var invoice_no = jQuery("#addaccessory #accessory_invoice_no").val();
    var amount_invoice = jQuery("#addaccessory #accessory_amount_invoice").val();
    var ofasnumber = jQuery("#addaccessory #accessory_ofasnumber").val();
    var datediff = daydiff(parseDate(vehicle_in_date), parseDate(vehicle_out_date));

    if (meter_reading == "")
    {
        jQuery("#addaccessory #mr_error").show();
        jQuery("#addaccessory #mr_error").fadeOut(6000);
    }
    else if (dealerid == '-1')
    {
        jQuery("#addaccessory #dn_error").show();
        jQuery("#addaccessory #dn_error").fadeOut(6000);
    }
    else if (note == "")
    {
        jQuery("#addaccessory #notes_error").show();
        jQuery("#addaccessory #notes_error").fadeOut(6000);
    }
    else if (amount_quote == "")
    {
        jQuery("#addaccessory #qa_error").show();
        jQuery("#addaccessory #qa_error").fadeOut(6000);
    }
    else if (invoice_no == "")
    {
        jQuery("#addaccessory #in_error").show();
        jQuery("#addaccessory #in_error").fadeOut(6000);
    }
    else if (amount_invoice == "")
    {
        jQuery("#addaccessory #ia_error").show();
        jQuery("#addaccessory #ia_error").fadeOut(6000);
    }
    else if (datediff < 0)
    {
        jQuery("#addaccessory #datediff_error").show();
        jQuery("#addaccessory #datediff_error").fadeOut(6000);
    }
    else if (ofasnumber == "")
    {
        jQuery("#addaccessory #ofas_error").show();
        jQuery("#addaccessory #ofas_error").fadeOut(6000);
    }
    else if (amount_invoice > amount_quote)
    {
        jQuery("#addaccessory #ia_q_error").show();
        jQuery("#addaccessory #ia_q_error").fadeOut(6000);
    }
    /**
     else if(jQuery("#accessory_select_1").val() != "-1" && (parseInt(jQuery("#amount1").val()) > parseInt(jQuery("#max_amount_hid_1").val())))
     {
     jQuery("#max_perm_amount_error").show();
     jQuery("#max_perm_amount_error").fadeOut(6000);        
     }
     else if(jQuery("#accessory_select_2").val() != "-1" && (parseInt(jQuery("#amount2").val()) > parseInt(jQuery("#max_amount_hid_2").val())))
     {
     jQuery("#max_perm_amount_error").show();
     jQuery("#max_perm_amount_error").fadeOut(6000);        
     }
     else if(jQuery("#accessory_select_3").val() != "-1" && (parseInt(jQuery("#amount3").val()) > parseInt(jQuery("#max_amount_hid_3").val())))
     {
     jQuery("#max_perm_amount_error").show();
     jQuery("#max_perm_amount_error").fadeOut(6000);        
     }
     else if(jQuery("#accessory_select_4").val() != "-1" && (parseInt(jQuery("#amount4").val()) > parseInt(jQuery("#max_amount_hid_4").val())))
     {
     jQuery("#max_perm_amount_error").show();
     jQuery("#max_perm_amount_error").fadeOut(6000);        
     }
     else if(jQuery("#accessory_select_5").val() != "-1" && (parseInt(jQuery("#amount5").val()) > parseInt(jQuery("#max_amount_hid_5").val())))
     {
     jQuery("#max_perm_amount_error").show();
     jQuery("#max_perm_amount_error").fadeOut(6000);        
     }
     else if(jQuery("#accessory_select_6").val() != "-1" && (parseInt(jQuery("#amount6").val()) > parseInt(jQuery("#max_amount_hid_6").val())))
     {
     jQuery("#max_perm_amount_error").show();
     jQuery("#max_perm_amount_error").fadeOut(6000);        
     }
     else if(jQuery("#accessory_select_7").val() != "-1" && (parseInt(jQuery("#amount7").val()) > parseInt(jQuery("#max_amount_hid_7").val())))
     {
     jQuery("#max_perm_amount_error").show();
     jQuery("#max_perm_amount_error").fadeOut(6000);        
     }
     ***/
    else if (amount_quote > 22500)
    {
        jQuery("#quote_exceed_error").show();
        jQuery("#quote_exceed_error").fadeOut(6000);
    }

    else if (vehicleid != '') {
        var accessory_list = [];
        if (jQuery("#accessory_select_1").val() != "-1")
        {
            accessory_list.push(jQuery("#accessory_select_1").val() + "-" + jQuery("#amount1").val() + "-" + jQuery("#max_amount_hid_1").val());
        }
        if (jQuery("#accessory_select_2").val() != "-1")
        {
            accessory_list.push(jQuery("#accessory_select_2").val() + "-" + jQuery("#amount2").val() + "-" + jQuery("#max_amount_hid_2").val());
        }
        if (jQuery("#accessory_select_3").val() != "-1")
        {
            accessory_list.push(jQuery("#accessory_select_3").val() + "-" + jQuery("#amount3").val() + "-" + jQuery("#max_amount_hid_3").val());
        }
        if (jQuery("#accessory_select_4").val() != "-1")
        {
            accessory_list.push(jQuery("#accessory_select_4").val() + "-" + jQuery("#amount4").val() + "-" + jQuery("#max_amount_hid_4").val());
        }
        if (jQuery("#accessory_select_5").val() != "-1")
        {
            accessory_list.push(jQuery("#accessory_select_5").val() + "-" + jQuery("#amount5").val() + "-" + jQuery("#max_amount_hid_5").val());
        }
        if (jQuery("#accessory_select_6").val() != "-1")
        {
            accessory_list.push(jQuery("#accessory_select_6").val() + "-" + jQuery("#amount6").val() + "-" + jQuery("#max_amount_hid_6").val());
        }
        if (jQuery("#accessory_select_7").val() != "-1")
        {
            accessory_list.push(jQuery("#accessory_select_7").val() + "-" + jQuery("#amount7").val() + "-" + jQuery("#max_amount_hid_7").val());
        }
        var get_string = "&accessory_list=" + accessory_list.toString() + "";

        var data = jQuery('#getaccessory').serialize() + '&new_accessory_vehicleid=' + vehicleid + get_string;
        jQuery.ajax({
            url: "route_ajax.php",
            type: 'POST',
            cache: false,
            data: data,
            success: function (statuscheck) {
                if (statuscheck == "notok") {
                }
                else if (statuscheck == "ok") {
                    jQuery('#addaccessory').modal('hide');
                    jQuery("#maintenance_complete").val('done');
                    getaccessory();
                    $('#getaccessory')[0].reset();
                }
            }
        });
        return false;
    }
    else {
        alert('please fill up general details first!!');
    }
}

function addbattery()
{
    var vehicleid = jQuery('#edit_vehicle_id').val();
    if (vehicleid != '') {
        var data = new FormData();
        var data = jQuery('#getbattery').serialize() + '&new_batt_vehicleid=' + vehicleid;
        jQuery.ajax({
            url: "route_ajax.php",
            type: 'POST',
            cache: false,
            data: data,
            success: function (statuscheck) {
                if (statuscheck == "notok") {
                }
                else if (statuscheck == "ok") {
                    jQuery("#maintenance_complete").val('done');
                    jQuery('#addbattery').modal('hide');
                    jQuery("#maintenance_complete").val('done');
                    getbattery();
                    jQuery("#battery_success").show();
                    jQuery("#battery_success").fadeOut(6000);
                }
            }
        });
        return false;
    }
    else {
        alert('please fill up general details first!!');
    }
}

function addrepair()
{

    var vehicleid = jQuery('#edit_vehicle_id').val();
    if (vehicleid != '') {

        if (jQuery('#category_type').val() == '2') {
            var parts_list = [];
            jQuery('.parts_select_array').each(function (id, obj) {
                parts_list.push(obj.value);
            });
            // convering array into strin and assigning to the getstring url
            var partlist = "&parts_list=" + parts_list.toString() + "";
            var task_select_array = [];
            jQuery('.task_select_array').each(function (id, obj) {
                task_select_array.push(obj.value);
            });
            // convering array into strin and assigning to the getstring url
            var tasklist = "&task_select_array=" + task_select_array.toString() + "";
            var data = jQuery('#getrepair').serialize() + partlist + tasklist + '&new_repair_vehicleid=' + vehicleid;
        }
        else {
            var data = jQuery('#getrepair').serialize() + '&new_repair_vehicleid=' + vehicleid;
        }
        jQuery.ajax({
            url: "route_ajax.php",
            type: 'POST',
            cache: false,
            data: data,
            success: function (statuscheck) {
                if (statuscheck == "notok") {
                }
                else if (statuscheck == "ok") {
                    jQuery("#maintenance_complete").val('done');
                    jQuery('#addrepair').modal('hide');
                    jQuery("#maintenance_complete").val('done');
                    getrepair();
                    jQuery("#repair_success").show();
                    jQuery("#repair_success").fadeOut(6000);
                }
            }
        });
        return false;
    }
    else {
        alert('please fill up general details first!!');
    }
}

function gettax()
{
    var vehicle_id = jQuery('#edit_vehicle_id').val();
    var veh_read_val = jQuery('#edit_veh_readonly').val();

    if (vehicle_id != '') {

        jQuery.ajax({
            url: "route_ajax.php",
            type: 'POST',
            cache: false,
            data: {tax_vehicle_id: vehicle_id, edit_veh_readonly_tax: veh_read_val},
            dataType: 'html',
            success: function (html) {
                jQuery("#tax_body").html('');
                jQuery("#tax_body").append(html);
            }
        });
        return false;
    }
    else {
        alert('please fill up general details first!!');
    }

}

function get_tax(taxid)
{
    if (taxid != '') {

        jQuery.ajax({
            url: "route_ajax.php",
            type: 'POST',
            cache: false,
            data: {tax_id: taxid},
            dataType: "json",
            success: function (data) {
                jQuery('#edit_from_date').val(data.from_date);
                jQuery('#edit_to_date').val(data.to_date);
                jQuery('#edit_tax_type').val(data.type);
                jQuery('#edit_amount').val(data.amount);
                jQuery('#edit_registrationno').val(data.reg_no);
                if (data.type == '2') {
                    jQuery('#edit_reg_name').show();
                    jQuery('#edit_registrationno').show();
                }
                else {
                    jQuery('#edit_reg_name').hide();
                    jQuery('#edit_registrationno').hide();
                }
                jQuery('#edit_save_tax').attr({onclick: 'edit_tax(' + taxid + ')'})
                jQuery('#edittax').modal('show');
            }
        });
        return false;
    }
    else {
        alert('please fill up general details first!!');
    }

}

function get_battery(maintenanceid)
{
    if (maintenanceid != '') {

        jQuery.ajax({
            url: "route_ajax.php",
            type: 'POST',
            cache: false,
            data: {battery_maintenanceid: maintenanceid},
            dataType: "json",
            success: function (data) {
                jQuery('#getbattery_edit #batt_meter_reading').val(data.meter_reading);
                jQuery('#getbattery_edit #batt_vehicle_in_date').val(data.vehicle_in_date);
                jQuery('#getbattery_edit #batt_vehicle_out_date').val(data.vehicle_out_date);
                jQuery('#getbattery_edit #batt_amount_quote').val(data.amount_quote);
                jQuery('#getbattery_edit #batt_invoice_date').val(data.invoice_date);
                jQuery('#getbattery_edit #batt_submission_date').val(data.submission_date);
                jQuery('#getbattery_edit #batt_approval_date').val(data.approval_date);
                jQuery('#getbattery_edit #batt_invoice_no').val(data.batt_invoice_no);
                jQuery('#getbattery_edit #batt_amount_invoice').val(data.invoice_amount);
                jQuery('#getbattery_edit #batt_dealerid').val(data.dealer_id);
                jQuery('#getbattery_edit #note_batt').val(data.notes);

                jQuery('#getbattery_edit #batt_payment_submission_date').val(data.payment_submission_date);
                jQuery('#getbattery_edit #batt_payment_approval_date').val(data.payment_approval_date);
                jQuery('#getbattery_edit #batt_ofasnumber').val(data.ofasnumber);

                jQuery('#maintenance_edit_id').val(maintenanceid);
                jQuery('#getbattery_edit #edit_save_battery').attr({onclick: 'editbattery(' + maintenanceid + ')'});
                checkfilename(maintenanceid, 0, 'quote', data.quote_file_name, 'battery', jQuery('#edit_vehicle_id').val(), jQuery('#customerno').val());
                checkfilename(maintenanceid, 0, 'invoice', data.invoice_file_name, 'battery', jQuery('#edit_vehicle_id').val(), jQuery('#customerno').val());
                jQuery('#editbattery').modal('show');
            }
        });
        return false;
    }
    else {
        alert('please fill up general details first!!');
    }
}

function get_accessory(maintenanceid)
{
    if (maintenanceid != '') {

        jQuery.ajax({
            url: "route_ajax.php",
            type: 'POST',
            cache: false,
            data: {battery_maintenanceid: maintenanceid},
            dataType: "json",
            success: function (data) {
                jQuery('#getaccessory_edit #accessory_meter_reading').val(data.meter_reading);
                jQuery('#getaccessory_edit #accessory_vehicle_in_date').val(data.vehicle_in_date);
                jQuery('#getaccessory_edit #accessory_vehicle_out_date').val(data.vehicle_out_date);
                jQuery('#getaccessory_edit #accessory_amount_quote').val(data.amount_quote);
                jQuery('#getaccessory_edit #accessory_invoice_date').val(data.invoice_date);
                jQuery('#getaccessory_edit #accessory_submission_date').val(data.submission_date);
                jQuery('#getaccessory_edit #accessory_approval_date').val(data.approval_date);
                jQuery('#getaccessory_edit #accessory_invoice_no').val(data.batt_invoice_no);
                jQuery('#getaccessory_edit #accessory_amount_invoice').val(data.invoice_amount);
                jQuery('#getaccessory_edit #accessory_dealerid').val(data.dealer_id);
                jQuery('#getaccessory_edit #note_accessory').val(data.notes);

                jQuery('#getaccessory_edit #accessory_payment_submission_date').val(data.payment_submission_date);
                jQuery('#getaccessory_edit #accessory_payment_approval_date').val(data.payment_approval_date);
                jQuery('#getaccessory_edit #accessory_ofasnumber').val(data.ofasnumber);

                jQuery("#getaccessory_edit #get_accessories_div").html(data.get_accessories);
                jQuery('#maintenance_edit_id').val(maintenanceid);
                jQuery('#getaccessory_edit #edit_save_accessory').attr({onclick: 'editaccessory(' + maintenanceid + ')'});
                checkfilename(maintenanceid, 0, 'quote', data.quote_file_name, 'accessory', jQuery('#edit_vehicle_id').val(), jQuery('#customerno').val());
                checkfilename(maintenanceid, 0, 'invoice', data.invoice_file_name, 'accessory', jQuery('#edit_vehicle_id').val(), jQuery('#customerno').val());
                jQuery('#editaccessory').modal('show');
            }
        });
        return false;
    }
    else {
        alert('please fill up general details first!!');
    }

}

function checkfilename(maintenanceid, category, type, filename, transaction, vehicleid, customerno) {
    if (filename == "")
    {
        filename = "undefined";
    }
    var url = '../../customer/' + customerno + '/vehicleid/' + vehicleid + '/' + filename;
    jQuery.ajax({
        type: "HEAD",
        url: url,
        success: function (data) {
            jQuery("#get" + transaction + "_edit #" + transaction + "_" + type + "file_view").html("");
            jQuery("#get" + transaction + "_edit #" + transaction + "_" + type + "file_view").html("<a href='download.php?download_file=" + filename + "&vid=" + vehicleid + "&customerno=" + customerno + "'>Download " + type + " file here</a>");
        },
        error: function (request, status) {
            jQuery("#get" + transaction + "_edit #" + transaction + "_" + type + "file_view").html("");
            jQuery("#get" + transaction + "_edit #" + transaction + "_" + type + "file_view").html("No " + type + " file Uploaded");
        }
    });
}

function checkfile(maintenanceid, category, type, transaction, vehicleid, customerno) {
    var url = '../../customer/' + customerno + '/vehicleid/' + vehicleid + '/' + maintenanceid + '_' + category + '_' + type + '.pdf';
    jQuery.ajax({
        type: "HEAD",
        url: url,
        success: function (data) {
            jQuery("#get" + transaction + "_edit #" + transaction + "_" + type + "file_view").html("");
            jQuery("#get" + transaction + "_edit #" + transaction + "_" + type + "file_view").html("<a href='download.php?download_file=" + maintenanceid + "_" + category + "_" + type + ".pdf&vid=" + vehicleid + "&customerno=" + customerno + "'>Download " + type + " file here</a>");
        },
        error: function (request, status) {
            jQuery("#get" + transaction + "_edit #" + transaction + "_" + type + "file_view").html("");
            jQuery("#get" + transaction + "_edit #" + transaction + "_" + type + "file_view").html("No " + type + " file Uploaded");
        }
    });
}

function get_tyre(maintenanceid)
{
    if (maintenanceid != '') {

        jQuery.ajax({
            url: "route_ajax.php",
            type: 'POST',
            cache: false,
            data: {tyre_maintenanceid: maintenanceid},
            dataType: "json",
            success: function (data) {
                jQuery('#gettyre_edit #tyre_meter_reading').val(data.meter_reading);
                jQuery('#gettyre_edit #tyre_vehicle_in_date').val(data.vehicle_in_date);
                jQuery('#gettyre_edit #tyre_vehicle_out_date').val(data.vehicle_out_date);
                jQuery('#gettyre_edit #tyre_amount_quote').val(data.amount_quote);
                jQuery('#gettyre_edit #tyre_invoice_date').val(data.invoice_date);
                jQuery('#gettyre_edit #tyre_submission_date').val(data.submission_date);
                jQuery('#gettyre_edit #tyre_approval_date').val(data.approval_date);
                jQuery('#gettyre_edit #tyre_invoice_no').val(data.batt_invoice_no);
                jQuery('#gettyre_edit #tyre_amount_invoice').val(data.invoice_amount);
                jQuery('#gettyre_edit #tyre_dealerid').val(data.dealer_id);
                jQuery('#gettyre_edit #note_tyre').val(data.notes);

                jQuery('#gettyre_edit #tyre_payment_submission_date').val(data.payment_submission_date);
                jQuery('#gettyre_edit #tyre_payment_approval_date').val(data.payment_approval_date);
                jQuery('#gettyre_edit #tyre_ofasnumber').val(data.ofasnumber);

                jQuery('#maintenance_edit_id').val(maintenanceid);
                jQuery('#gettyre_edit #tyre_type_view').text(data.tyre_type);

                jQuery('#edit_save_tyre').attr({onclick: 'edittyre(' + maintenanceid + ')'});
                checkfilename(maintenanceid, 1, 'quote', data.quote_file_name, 'tyre', jQuery('#edit_vehicle_id').val(), jQuery('#customerno').val());
                checkfilename(maintenanceid, 1, 'invoice', data.invoice_file_name, 'tyre', jQuery('#edit_vehicle_id').val(), jQuery('#customerno').val());
                jQuery('#edittyre').modal('show');
            }
        });
        return false;
    }
    else {
        alert('please fill up general details first!!');
    }

}

function get_repair(maintenanceid)
{
    if (maintenanceid != '') {

        jQuery.ajax({
            url: "route_ajax.php",
            type: 'POST',
            cache: false,
            data: {repair_maintenanceid: maintenanceid},
            dataType: "json",
            success: function (data) {

                jQuery('#getrepair_edit #repair_meter_reading').val(data.meter_reading);
                jQuery('#getrepair_edit #repair_vehicle_in_date').val(data.vehicle_in_date);
                jQuery('#getrepair_edit #repair_vehicle_out_date').val(data.vehicle_out_date);
                jQuery('#getrepair_edit #repair_amount_quote').val(data.amount_quote);
                jQuery('#getrepair_edit #repair_invoice_date').val(data.invoice_date);
                jQuery('#getrepair_edit #repair_submission_date').val(data.submission_date);
                jQuery('#getrepair_edit #repair_approval_date').val(data.approval_date);
                jQuery('#getrepair_edit #repair_invoice_no').val(data.batt_invoice_no);
                jQuery('#getrepair_edit #repair_amount_invoice').val(data.invoice_amount);
                jQuery('#getrepair_edit #repair_dealerid').val(data.dealer_id);
                jQuery('#getrepair_edit #note_repair').val(data.notes);

                jQuery('#getrepair_edit #repair_payment_submission_date').val(data.payment_submission_date);
                jQuery('#getrepair_edit #repair_payment_approval_date').val(data.payment_approval_date);
                jQuery('#getrepair_edit #repair_ofasnumber').val(data.ofasnumber);

                jQuery('#maintenance_edit_id').val(maintenanceid);
                jQuery('#getrepair_edit #parts_view').text(data.partsnew);
                jQuery('#getrepair_edit #tasks_view').text(data.tasksnew);

                jQuery('#edit_save_repair').attr({onclick: 'editrepair(' + maintenanceid + ')'});
                checkfilename(maintenanceid, data.category_type, 'quote', data.quote_file_name, 'repair', jQuery('#edit_vehicle_id').val(), jQuery('#customerno').val());
                checkfilename(maintenanceid, data.category_type, 'invoice', data.invoice_file_name, 'repair', jQuery('#edit_vehicle_id').val(), jQuery('#customerno').val());
                jQuery('#editrepair').modal('show');
            }
        });
        return false;
    }
    else {
        alert('please fill up general details first!!');
    }

}


jQuery(".change_val").change(function () {

    var actual_amount = jQuery('#actual_amount').val();
    var sett_amount = jQuery('#sett_amount').val();
    jQuery('#mahindra_amount').val(actual_amount - sett_amount);
});

function get_accident(maintenanceid)
{


    if (maintenanceid != '') {

        jQuery.ajax({
            url: "route_ajax.php",
            type: 'POST',
            cache: false,
            data: {acc_maintenance_id: maintenanceid},
            dataType: "json",
            success: function (data) {
                jQuery('#editaccident_approval #acc_Date').val(data.acc_Date);
                jQuery('#editaccident_approval #STime').val(data.STime);
                jQuery('#editaccident_approval #acc_location').val(data.acc_location);
                jQuery('#editaccident_approval #acc_desc').val(data.acc_desc);
                jQuery('#editaccident_approval #driver_name').val(data.driver_name);
                jQuery('#editaccident_approval #val_from_Date').val(data.val_from_Date);
                jQuery('#editaccident_approval #val_to_Date').val(data.val_to_Date);
                jQuery('#editaccident_approval #licence_type').val(data.licence_type);
                jQuery('#editaccident_approval #add_workshop').val(data.add_workshop);
                jQuery('#editaccident_approval #send_report').val(data.send_report);
                jQuery('#editaccident_approval #loss_amount').val(data.loss_amount);
                jQuery('#editaccident_approval #sett_amount').val(data.sett_amount);
                jQuery('#editaccident_approval #actual_amount').val(data.actual_amount);
                jQuery('#editaccident_approval #mahindra_amount').val(data.mahindra_amount);

                jQuery('#editaccident_approval #acc_submission_date').val(data.submission_date);
                jQuery('#editaccident_approval #acc_approval_date').val(data.approval_date);
                jQuery('#editaccident_approval #acc_ofasnumber').val(data.ofasnumber);

                jQuery('#editacc_maintainanceid').val(maintenanceid);

                jQuery(data.files).each(function (index, obj) {

                    jQuery("#accident_files_view").append('<a href="' + obj.url.toString() + '" target="_blank">' + obj.name.toString() + '</a><br>');
                });

                jQuery('#editaccident').modal('show');

            }
        });
        return false;
    }
    else {
        alert('please fill up general details first!!');
    }

}

function category_selector() {
    var category_type = jQuery("#category_type option:selected").val();
    jQuery("#category_handler").html("");
    if (category_type == 2) {
        jQuery("#category_handler").html(jQuery("#parts_task").html());
    }
    else {
        jQuery("#category_handler").html("");
    }
    if (category_type == 2 || category_type == 3) {
        jQuery("#category_id").val(category_type);
    }

}

function category_selector_edit_pop(category_type) {
//     var category_type= jQuery("#category_type_edit option:selected").val();
    jQuery("#category_handler_edit").html("");
    if (category_type == 2) {
        jQuery("#category_handler_edit").html(jQuery("#parts_task_edit").html());
    }
    else {
        jQuery("#category_handler_edit").html("");
    }
    if (category_type == 2 || category_type == 3) {
        jQuery("#category_id").val(category_type);
    }

}

function category_selector_edit() {
    var category_type = jQuery("#category_type_edit option:selected").val();
    jQuery("#category_handler_edit").html("");
    if (category_type == 2) {
        jQuery("#category_handler_edit").html(jQuery("#parts_task").html());
    }
    else {
        jQuery("#category_handler_edit").html("");
    }
    if (category_type == 2 || category_type == 3) {
        jQuery("#category_id").val(category_type);
    }

}

function add_items_container(target, type) {
    var itemsel = jQuery("#" + type + " option:selected").val();
    var itemtext = jQuery("#" + type + " option:selected").text();
    if (itemsel != "" && itemsel != "-1") {
        if (jQuery('#' + type + '_' + itemsel).val() == null)
        {
            jQuery(target).append("<p class='btn btn-primary'  id='" + type + "_" + itemsel + "'>" + itemtext + "<input type='hidden' class='" + type + "_array' name='tyre_type[]' value='" + itemsel + "'/> <span onclick='jQuery(this).parent().remove();'>x</span></p> ");
        }
        else
        {
            // Do Nothing
        }
    }
    else {
        alert("select a type first");
    }


}

var files_batt;
var files_invoice;

// Add events
jQuery('#batt_file_for_quote').on('change', prepareUploadQuote);
jQuery('#batt_file_for_invoice').on('change', prepareUploadInvoice);
jQuery('#accessory_file_for_quote').on('change', prepareUploadQuote);
jQuery('#accessory_file_for_invoice').on('change', prepareUploadInvoice);
jQuery('#tyre_file_for_quote').on('change', prepareUploadQuote);
jQuery('#tyre_file_for_invoice').on('change', prepareUploadInvoice);
jQuery('#repair_file_for_quote').on('change', prepareUploadQuote);
jQuery('#repair_file_for_invoice').on('change', prepareUploadInvoice);
jQuery('#file1').on('change', prepareUploadAccident);
jQuery('#file2').on('change', prepareUploadAccident);
jQuery('#file3').on('change', prepareUploadAccident);
jQuery('#file4').on('change', prepareUploadAccident);
jQuery('#file5').on('change', prepareUploadAccident);

jQuery('#efile1').on('change', prepareUploadAccident);
jQuery('#efile2').on('change', prepareUploadAccident);
jQuery('#efile3').on('change', prepareUploadAccident);
jQuery('#efile4').on('change', prepareUploadAccident);
jQuery('#efile5').on('change', prepareUploadAccident);




function prepareUploadAccident(event)
{
    files_batt = null;
    files_batt = event.target.files;
    uploadFilesACC(event, this.id);
}


function uploadFilesACC(event, id)
{
    var edit_vehicle_id = jQuery('#edit_vehicle_id').val();
    if (edit_vehicle_id != "") {

        var data = new FormData();
        jQuery.each(files_batt, function (key, value)
        {
            data.append(key, value);
        });
        files = null;
        jQuery.ajax({
            url: 'upload.php?vehicleid=' + edit_vehicle_id + '&acc=true&inp_id=' + id,
            type: 'POST',
            data: data,
            cache: false,
            dataType: 'json',
            processData: false, // Don't process the files
            contentType: false, // Set content type to false as jQuery will tell the server its a query string request
            success: function (data, textStatus, jqXHR)
            {
                if (typeof data.error === 'undefined')
                {

                }
                else
                {
                    // Handle errors here
                    console.log('ERRORS: ' + data.error);
                }
            },
            error: function (jqXHR, textStatus, errorThrown)
            {
                // Handle errors here
                console.log('ERRORS: ' + textStatus);
                // STOP LOADING SPINNER
            }
        });
    }
    else {
        alert('please select a file to upload');
        files = null;
    }
}

// Grab the files and set them to our variable
function prepareUploadQuote(event)
{
    files_batt = null;
    files_batt = event.target.files;
    uploadFilesQuote(event);
}
function prepareUploadInvoice(event)
{
    files_invoice = null;
    files_invoice = event.target.files;
    uploadFilesInvoice(event);
}

function uploadFilesQuote(event)
{
    if (jQuery('#batt_file_for_quote').val() != '' || jQuery('#tyre_file_for_quote').val() != '' || jQuery('#repair_file_for_quote').val() != '' || jQuery('#accessory_file_for_quote').val() != '') {
        var edit_vehicle_id = jQuery('#edit_vehicle_id').val();
        var data = new FormData();
        jQuery.each(files_batt, function (key, value)
        {
            data.append(key, value);
        });
        files = null;
        jQuery.ajax({
            url: 'upload.php?vehicleid=' + edit_vehicle_id + '&quote',
            type: 'POST',
            data: data,
            cache: false,
            dataType: 'json',
            processData: false, // Don't process the files
            contentType: false, // Set content type to false as jQuery will tell the server its a query string request
            success: function (data, textStatus, jqXHR)
            {
                if (typeof data.error === 'undefined')
                {
//                                jQuery("#upload_puc").val('Upload Successfully');
//                                jQuery("#upload_puc").attr('disabled', 'disabled');
//                                jQuery("#puc").hide();
                }
                else
                {
                    // Handle errors here
                    console.log('ERRORS: ' + data.error);
                }
            },
            error: function (jqXHR, textStatus, errorThrown)
            {
                // Handle errors here
                console.log('ERRORS: ' + textStatus);
                // STOP LOADING SPINNER
            }
        });
    }
    else {
        alert('please select a file to upload');
        files = null;
    }
}

function uploadFilesInvoice(event)
{
    if (jQuery('#batt_file_for_invoice').val() != '' || jQuery('#tyre_file_for_invoice').val() != '' || jQuery('#repair_file_for_invoice').val() != '' || jQuery('#accessory_file_for_invoice').val() != '') {
        var edit_vehicle_id = jQuery('#edit_vehicle_id').val();
        var maintenanceid = jQuery('#maintenance_edit_id').val();
        var data = new FormData();
        jQuery.each(files_invoice, function (key, value)
        {
            data.append(key, value);
        });
        files = null;
        jQuery.ajax({
            url: 'upload.php?vehicleid=' + edit_vehicle_id + '&maintenanceid=' + maintenanceid + '&invoice',
            type: 'POST',
            data: data,
            cache: false,
            dataType: 'json',
            processData: false, // Don't process the files
            contentType: false, // Set content type to false as jQuery will tell the server its a query string request
            success: function (data, textStatus, jqXHR)
            {
                if (typeof data.error === 'undefined')
                {
//                                jQuery("#upload_puc").val('Upload Successfully');
//                                jQuery("#upload_puc").attr('disabled', 'disabled');
//                                jQuery("#puc").hide();
                }
                else
                {
                    // Handle errors here
                    console.log('ERRORS: ' + data.error);
                }
            },
            error: function (jqXHR, textStatus, errorThrown)
            {
                // Handle errors here
                console.log('ERRORS: ' + textStatus);
                // STOP LOADING SPINNER
            }
        });
    }
    else {
        alert('please select a file to upload');
        files = null;
    }
}

function editacc(maintenanceid)
{

    var edit_vehicleid_history = jQuery('#edit_vehicleid').val();
    var editacc_maintainanceid = jQuery('#editacc_maintainanceid').val();

    if (edit_vehicleid_history != '') {
        var data = jQuery('#editaccident_approval').serialize() + '&edit_vehicleid_history=' + edit_vehicleid_history + '&editacc_maintainanceid=' + editacc_maintainanceid;
        jQuery.ajax({
            url: "route_ajax.php",
            type: 'POST',
            cache: false,
            data: data,
            success: function (statuscheck) {
                if (statuscheck == "notok") {
                }
                else if (statuscheck == "ok") {
                    jQuery('#editaccident').modal('hide');
                    jQuery(".file-input-name").html("");
                    getaccident();
                    jQuery("#accident_files_view").html('');
                }
            }
        });
        return false;
    }
    else {
        alert('please fill up general details first!!');
    }
}
function editbattery(maintenanceid)
{
    var vehicleid = jQuery('#edit_vehicle_id').val();
    var meter_reading = jQuery("#editbattery #batt_meter_reading").val();
    var dealerid = jQuery("#editbattery #batt_dealerid option:selected").val();
    var note = jQuery("#editbattery #note_batt").val();
    var vehicle_in_date = jQuery("#editbattery #batt_vehicle_in_date").val();
    var vehicle_out_date = jQuery("#editbattery #batt_vehicle_out_date").val();
    var amount_quote = jQuery("#editbattery #batt_amount_quote").val();
    var invoice_no = jQuery("#editbattery #batt_invoice_no").val();
    var amount_invoice = jQuery("#editbattery #batt_amount_invoice").val();
    var ofasnumber = jQuery("#editbattery #batt_ofasnumber").val();
    var datediff = daydiff(parseDate(vehicle_in_date), parseDate(vehicle_out_date));

    if (meter_reading == "")
    {
        jQuery("#editbattery #mr_error").show();
        jQuery("#editbattery #mr_error").fadeOut(6000);
    }
    else if (dealerid == '-1')
    {
        jQuery("#editbattery #dn_error").show();
        jQuery("#editbattery #dn_error").fadeOut(6000);
    }
    else if (note == "")
    {
        jQuery("#editbattery #notes_error").show();
        jQuery("#editbattery #notes_error").fadeOut(6000);
    }
    else if (amount_quote == "")
    {
        jQuery("#editbattery #qa_error").show();
        jQuery("#editbattery #qa_error").fadeOut(6000);
    }
    else if (invoice_no == "")
    {
        jQuery("#editbattery #in_error").show();
        jQuery("#editbattery #in_error").fadeOut(6000);
    }
    else if (amount_invoice == "")
    {
        jQuery("#editbattery #ia_error").show();
        jQuery("#editbattery #ia_error").fadeOut(6000);
    }
    else if (datediff < 0)
    {
        jQuery("#editbattery #datediff_error").show();
        jQuery("#editbattery #datediff_error").fadeOut(6000);
    }
    else if (ofasnumber == "")
    {
        jQuery("#editbattery #ofas_error").show();
        jQuery("#editbattery #ofas_error").fadeOut(6000);
    }
    else if (amount_invoice > amount_quote)
    {
        jQuery("#editbattery #ia_q_error").show();
        jQuery("#editbattery #ia_q_error").fadeOut(6000);
    }
    else if (vehicleid != '') {
        var data = jQuery('#getbattery_edit').serialize() + '&edit_batt_vehicleid=' + vehicleid + '&maintenanceid=' + maintenanceid;
        jQuery.ajax({
            url: "route_ajax.php",
            type: 'POST',
            cache: false,
            data: data,
            success: function (statuscheck) {
                if (statuscheck == "notok") {
                }
                else if (statuscheck == "ok") {
                    jQuery("#maintenance_complete").val('done');
                    jQuery('#editbattery').modal('hide');
                    getbattery();
                }
            }
        });
        return false;
    }
    else {
        alert('please fill up general details first!!');
    }
}

function editaccessory(maintenanceid)
{
    var vehicleid = jQuery('#edit_vehicle_id').val();
    var meter_reading = jQuery("#editaccessory #accessory_meter_reading").val();
    var dealerid = jQuery("#editaccessory #accessory_dealerid option:selected").val();
    var note = jQuery("#editaccessory #note_accessory").val();
    var vehicle_in_date = jQuery("#editaccessory #accessory_vehicle_in_date").val();
    var vehicle_out_date = jQuery("#editaccessory #accessory_vehicle_out_date").val();
    var amount_quote = jQuery("#editaccessory #accessory_amount_quote").val();
    var invoice_no = jQuery("#editaccessory #accessory_invoice_no").val();
    var amount_invoice = jQuery("#editaccessory #accessory_amount_invoice").val();
    var ofasnumber = jQuery("#editaccessory #accessory_ofasnumber").val();
    var datediff = daydiff(parseDate(vehicle_in_date), parseDate(vehicle_out_date));

    if (meter_reading == "")
    {
        jQuery("#editaccessory #mr_error").show();
        jQuery("#editaccessory #mr_error").fadeOut(6000);
    }
    else if (dealerid == '-1')
    {
        jQuery("#editaccessory #dn_error").show();
        jQuery("#editaccessory #dn_error").fadeOut(6000);
    }
    else if (note == "")
    {
        jQuery("#editaccessory #notes_error").show();
        jQuery("#editaccessory #notes_error").fadeOut(6000);
    }
    else if (amount_quote == "")
    {
        jQuery("#editaccessory #qa_error").show();
        jQuery("#editaccessory #qa_error").fadeOut(6000);
    }
    else if (invoice_no == "")
    {
        jQuery("#editaccessory #in_error").show();
        jQuery("#editaccessory #in_error").fadeOut(6000);
    }
    else if (amount_invoice == "")
    {
        jQuery("#editaccessory #ia_error").show();
        jQuery("#editaccessory #ia_error").fadeOut(6000);
    }
    else if (datediff < 0)
    {
        jQuery("#editaccessory #datediff_error").show();
        jQuery("#editaccessory #datediff_error").fadeOut(6000);
    }
    else if (ofasnumber == "")
    {
        jQuery("#editaccessory #ofas_error").show();
        jQuery("#editaccessory #ofas_error").fadeOut(6000);
    }
    else if (amount_invoice > amount_quote)
    {
        jQuery("#editaccessory #ia_q_error").show();
        jQuery("#editaccessory #ia_q_error").fadeOut(6000);
    }
    else if (vehicleid != '') {
        var data = jQuery('#getaccessory_edit').serialize() + '&edit_accessory_vehicleid=' + vehicleid + '&maintenanceid=' + maintenanceid;
        jQuery.ajax({
            url: "route_ajax.php",
            type: 'POST',
            cache: false,
            data: data,
            success: function (statuscheck) {
                if (statuscheck == "notok") {
                }
                else if (statuscheck == "ok") {
                    jQuery("#maintenance_complete").val('done');
                    jQuery('#editaccessory').modal('hide');
                    getbattery();
                }
            }
        });
        return false;
    }
    else {
        alert('please fill up general details first!!');
    }
}

function edittyre(maintenanceid)
{
    var vehicleid = jQuery('#edit_vehicle_id').val();
    var meter_reading = jQuery("#edittyre #tyre_meter_reading").val();
    var dealerid = jQuery("#edittyre #tyre_dealerid option:selected").val();
    var note = jQuery("#edittyre #note_tyre").val();
    var vehicle_in_date = jQuery("#edittyre #tyre_vehicle_in_date").val();
    var vehicle_out_date = jQuery("#edittyre #tyre_vehicle_out_date").val();
    var amount_quote = jQuery("#edittyre #tyre_amount_quote").val();
    var invoice_no = jQuery("#edittyre #tyre_invoice_no").val();
    var amount_invoice = jQuery("#edittyre #tyre_amount_invoice").val();
    var ofasnumber = jQuery("#edittyre #tyre_ofasnumber").val();
    var datediff = daydiff(parseDate(vehicle_in_date), parseDate(vehicle_out_date));

    if (meter_reading == "")
    {
        jQuery("#edittyre #mr_error").show();
        jQuery("#edittyre #mr_error").fadeOut(6000);
    }
    else if (dealerid == '-1')
    {
        jQuery("#edittyre #dn_error").show();
        jQuery("#edittyre #dn_error").fadeOut(6000);
    }
    else if (note == "")
    {
        jQuery("#edittyre #notes_error").show();
        jQuery("#edittyre #notes_error").fadeOut(6000);
    }
    else if (amount_quote == "")
    {
        jQuery("#edittyre #qa_error").show();
        jQuery("#edittyre #qa_error").fadeOut(6000);
    }
    else if (invoice_no == "")
    {
        jQuery("#edittyre #in_error").show();
        jQuery("#edittyre #in_error").fadeOut(6000);
    }
    else if (amount_invoice == "")
    {
        jQuery("#edittyre #ia_error").show();
        jQuery("#edittyre #ia_error").fadeOut(6000);
    }
    else if (datediff < 0)
    {
        jQuery("#edittyre #datediff_error").show();
        jQuery("#edittyre #datediff_error").fadeOut(6000);
    }
    else if (ofasnumber == "")
    {
        jQuery("#edittyre #ofas_error").show();
        jQuery("#edittyre #ofas_error").fadeOut(6000);
    }
    else if (amount_invoice > amount_quote)
    {
        jQuery("#edittyre #ia_q_error").show();
        jQuery("#edittyre #ia_q_error").fadeOut(6000);
    }
    else if (vehicleid != '') {
        var data = jQuery('#gettyre_edit').serialize() + '&edit_tyre_vehicleid=' + vehicleid + '&maintenanceid=' + maintenanceid;
        jQuery.ajax({
            url: "route_ajax.php",
            type: 'POST',
            cache: false,
            data: data,
            success: function (statuscheck) {
                if (statuscheck == "notok") {
                }
                else if (statuscheck == "ok") {
                    jQuery("#maintenance_complete").val('done');
                    jQuery('#edittyre').modal('hide');
                    gettyre();
                }
            }
        });
        return false;
    }
    else {
        alert('please fill up general details first!!');
    }
}

function editrepair(maintenanceid)
{
    var vehicleid = jQuery('#edit_vehicle_id').val();
    var meter_reading = jQuery("#editrepair #repair_meter_reading").val();
    var dealerid = jQuery("#editrepair #repair_dealerid option:selected").val();
    var note = jQuery("#editrepair #note_repair").val();
    var vehicle_in_date = jQuery("#editrepair #repair_vehicle_in_date").val();
    var vehicle_out_date = jQuery("#editrepair #repair_vehicle_out_date").val();
    var amount_quote = jQuery("#editrepair #repair_amount_quote").val();
    var invoice_no = jQuery("#editrepair #repair_invoice_no").val();
    var amount_invoice = jQuery("#editrepair #repair_amount_invoice").val();
    var ofasnumber = jQuery("#editrepair #repair_ofasnumber").val();
    var datediff = daydiff(parseDate(vehicle_in_date), parseDate(vehicle_out_date));

    if (meter_reading == "")
    {
        jQuery("#editrepair #mr_error").show();
        jQuery("#editrepair #mr_error").fadeOut(6000);
    }
    else if (dealerid == '-1')
    {
        jQuery("#editrepair #dn_error").show();
        jQuery("#editrepair #dn_error").fadeOut(6000);
    }
    else if (note == "")
    {
        jQuery("#editrepair #notes_error").show();
        jQuery("#editrepair #notes_error").fadeOut(6000);
    }
    else if (amount_quote == "")
    {
        jQuery("#editrepair #qa_error").show();
        jQuery("#editrepair #qa_error").fadeOut(6000);
    }
    else if (invoice_no == "")
    {
        jQuery("#editrepair #in_error").show();
        jQuery("#editrepair #in_error").fadeOut(6000);
    }
    else if (amount_invoice == "")
    {
        jQuery("#editrepair #ia_error").show();
        jQuery("#editrepair #ia_error").fadeOut(6000);
    }
    else if (datediff < 0)
    {
        jQuery("#editrepair #datediff_error").show();
        jQuery("#editrepair #datediff_error").fadeOut(6000);
    }
    else if (ofasnumber == "")
    {
        jQuery("#editrepair #ofas_error").show();
        jQuery("#editrepair #ofas_error").fadeOut(6000);
    }
    else if (amount_invoice > amount_quote)
    {
        jQuery("#editrepair #ia_q_error").show();
        jQuery("#editrepair #ia_q_error").fadeOut(6000);
    }
    else if (vehicleid != '') {
        var data = jQuery('#getrepair_edit').serialize() + '&edit_repair_vehicleid=' + vehicleid + '&maintenanceid=' + maintenanceid;
        jQuery.ajax({
            url: "route_ajax.php",
            type: 'POST',
            cache: false,
            data: data,
            success: function (statuscheck) {
                if (statuscheck == "notok") {
                }
                else if (statuscheck == "ok") {
                    jQuery("#maintenance_complete").val('done');
                    jQuery('#editrepair').modal('hide');
                    getrepair();
                }
            }
        });
        return false;
    }
    else {
        alert('please fill up general details first!!');
    }
}

function edit_tax(taxid)
{
    var valid = 0;
    var vehicleid = jQuery('#edit_vehicle_id').val();
    if ((jQuery("#edit_amount").val() != '' && jQuery("#edit_amount").val().replace(/[^a-z]/g, "").length > 0) || (jQuery("#edit_amount").val() != '' && jQuery("#edit_amount").val().replace(/[^A-Z]/g, "").length > 0) || (jQuery("#edit_amount").val() != '' && jQuery("#edit_amount").val().length > 7))
    {
        jQuery("#edit_amount_error").show();
        jQuery("#edit_amount_error").fadeOut(6000);
    }
    else if ((jQuery("#edit_registrationno").val() != '' && jQuery("#edit_registrationno").val().replace(/[^a-z]/g, "").length > 0))
    {
        jQuery("#edit_registrationno_error").show();
        jQuery("#edit_registrationno_error").fadeOut(6000);
    }
    else if (jQuery("#edit_from_date").val() != "" && jQuery("#edit_to_date").val() != "")
    {
        var from_date = jQuery("#edit_from_date").val();
        var to_date = jQuery("#edit_to_date").val();
        var datediff = daydiff(parseDate(from_date), parseDate(to_date));
        if (datediff < 0) {
            jQuery("#edit_tax_datediff_error").show();
            jQuery("#edit_tax_datediff_error").fadeOut(6000);
        }
        else {
            if (jQuery("#yearofman").val() != "")
            {
                var yom = jQuery("#yearofman").val();
                var splitdate = from_date.split("-");
                var from_year = splitdate[2];
                var splitdate_to = to_date.split("-");
                var to_year = splitdate_to[2];
                if (yom <= from_year && yom <= to_year) {
                    valid = 1;
                }
                else {
                    jQuery("#edit_tax_year_error").show();
                    jQuery("#edit_tax_year_error").fadeOut(6000);
                }
            }
            if (taxid != '' && valid == 1) {
                var data = jQuery('#edit_tax').serialize() + '&edit_save_taxid=' + taxid + '&edit_tax_vehicle_id=' + vehicleid;
                jQuery.ajax({
                    url: "route_ajax.php",
                    type: 'POST',
                    cache: false,
                    data: data,
                    success: function (statuscheck) {
                        if (statuscheck == "ok") {
                            gettax();
                            jQuery('#edittax').modal('hide');
                        }
                    }
                });
                return false;
            }
            else if (vehicleid == '') {
                alert('please fill up general details first!!');
            }
        }
    }

}

function delete_tax(taxid)
{
    var vehicleid = jQuery('#edit_vehicle_id').val();
    if (taxid != '') {

        jQuery.ajax({
            url: "route_ajax.php",
            type: 'POST',
            cache: false,
            data: {delete_tax_id: taxid, tax_vehicleid: vehicleid},
            dataType: 'html',
            success: function (data) {
                if (data == 'ok') {
                    gettax();
                }
            }
        });
        return false;
    }
    else {
        alert('please fill up general details first!!');
    }

}

function delete_battery(maintenanceid)
{
    delete_maintenance(maintenanceid);

}

function delete_tyre(maintenanceid)
{
    delete_maintenance(maintenanceid);

}

function delete_repair(maintenanceid)
{
    delete_maintenance(maintenanceid);

}

function delete_accessory(maintenanceid)
{
    delete_maintenance(maintenanceid);

}

function delete_accident(maintenanceid)
{
    delete_accident_transaction(maintenanceid);

}

function delete_accident_transaction(maintenanceid)
{
    var vehicleid = jQuery('#edit_vehicle_id').val();
    if (vehicleid != '') {

        jQuery.ajax({
            url: "route_ajax.php",
            type: 'POST',
            cache: false,
            data: {delete_accidentid: maintenanceid, delete_vehicleid: vehicleid},
            dataType: 'html',
            success: function (data) {
                getaccident();
            }
        });
        return false;
    }
    else {
        alert('please fill up general details first!!');
    }

}
function delete_maintenance(maintenanceid)
{
    var vehicleid = jQuery('#edit_vehicle_id').val();
    if (vehicleid != '') {

        jQuery.ajax({
            url: "route_ajax.php",
            type: 'POST',
            cache: false,
            data: {delete_maintenanceid: maintenanceid, delete_vehicleid: vehicleid},
            dataType: 'html',
            success: function (data) {
                if (data == 'ok') {
                    getbattery();
                }
            }
        });
        return false;
    }
    else {
        alert('please fill up general details first!!');
    }

}


function getbattery()
{
    gettyre();
    getrepair();
    getaccessory();
    getaccident();
    var vehicle_id = jQuery('#edit_vehicle_id').val();
    if (vehicle_id != '') {

        jQuery.ajax({
            url: "route_ajax.php",
            type: 'POST',
            cache: false,
            data: {batt_vehicle_id: vehicle_id,
                type: '1'},
            dataType: 'html',
            success: function (html) {
                jQuery("#battery_body").html('');
                jQuery("#battery_body").append(html);
                gettyre();
                getrepair();
                getaccident();
            }
        });
        return false;
    }
    else {
        alert('please fill up general details first!!');
    }

}

function addtyre()
{

    var vehicleid = jQuery('#edit_vehicle_id').val();
    var tyre_list = [];
    jQuery('.tyre_type_array').each(function (id, obj) {
        tyre_list.push(obj.value);
    });
    // convering array into strin and assigning to the getstring url
    var tyrelist = "&tyre_list=" + tyre_list.toString() + "";
    if (vehicleid != '') {
        var data = jQuery('#gettyre').serialize() + tyrelist + '&new_tyre_vehicleid=' + vehicleid;
        jQuery.ajax({
            url: "route_ajax.php",
            type: 'POST',
            cache: false,
            data: data,
            success: function (statuscheck) {
                if (statuscheck == "notok") {
                }
                else if (statuscheck == "ok") {
                    jQuery("#maintenance_complete").val('done');
                    jQuery('#addtyre').modal('hide');
                    jQuery("#maintenance_complete").val('done');
                    gettyre();
                    jQuery("#tyre_success").show();
                    jQuery("#tyre_success").fadeOut(6000);
                }
            }
        });
        return false;
    }
    else {
        alert('please fill up general details first!!');
    }
}

function gettyre()
{
    var vehicle_id = jQuery('#edit_vehicle_id').val();
    if (vehicle_id != '') {

        jQuery.ajax({
            url: "route_ajax.php",
            type: 'POST',
            cache: false,
            data: {tyre_vehicle_id: vehicle_id,
                type: '1'},
            dataType: 'html',
            success: function (html) {
                jQuery("#tyre_body").html('');
                jQuery("#tyre_body").append(html);
            }
        });
        return false;
    }
    else {
        alert('please fill up general details first!!');
    }

}

function getrepair()
{
    var vehicle_id = jQuery('#edit_vehicle_id').val();
    if (vehicle_id != '') {

        jQuery.ajax({
            url: "route_ajax.php",
            type: 'POST',
            cache: false,
            data: {repair_vehicle_id: vehicle_id,
                type: '2'},
            dataType: 'html',
            success: function (html) {
                jQuery("#repair_body").html('');
                jQuery("#repair_body").append(html);
            }
        });
        return false;
    }
    else {
        alert('please fill up general details first!!');
    }

}

function getaccessory()
{
    var vehicle_id = jQuery('#edit_vehicle_id').val();
    if (vehicle_id != '') {

        jQuery.ajax({
            url: "route_ajax.php",
            type: 'POST',
            cache: false,
            data: {accessory_vehicle_id: vehicle_id,
                type: '5'},
            dataType: 'html',
            success: function (html) {
                jQuery("#accessory_body").html('');
                jQuery("#accessory_body").append(html);
            }
        });
        return false;
    }
    else {
        alert('please fill up general details first!!');
    }

}

function getaccident()
{
    var vehicle_id = jQuery('#edit_vehicle_id').val();
    if (vehicle_id != '') {

        jQuery.ajax({
            url: "route_ajax.php",
            type: 'POST',
            cache: false,
            data: {accident_hist_vehicle_id: vehicle_id},
            dataType: 'html',
            success: function (html) {
                jQuery("#accident_body").html('');
                jQuery("#accident_body").append(html);
            }
        });
        return false;
    }
    else {
        alert('please fill up general details first!!');
    }

}

function getservice()
{
    var vehicle_id = jQuery('#vehicle_id').val();
    if (vehicle_id != '') {

        jQuery.ajax({
            url: "route_ajax.php",
            type: 'POST',
            cache: false,
            data: {service_vehicle_id: vehicle_id,
                type: '1'},
            dataType: 'html',
            success: function (html) {
                jQuery("#service_body").html('');
                jQuery("#service_body").append(html);
            }
        });
        return false;
    }
    else {
        alert('please fill up general details first!!');
    }

}

function sendapproval() {
    var vehicle_id = jQuery('#edit_vehicle_id').val();
    if (vehicle_id != '') {
        editgeo();
        if (jQuery("#edit_engineno").val() != "" && jQuery("#chasisno").val() != "")
        {
            if (jQuery("#edit_cap_cost").val() > 1 && jQuery("#edit_cap_cost").val() != "")
            {
                jQuery.ajax({
                    url: "route_ajax.php",
                    type: 'POST',
                    cache: false,
                    data: {approval_vehicle_id: vehicle_id},
                    success: function (statuscheck) {
                        if (statuscheck == "notok") {
                        }
                        else if (statuscheck == "ok") {
                            window.location.href = "vehicle.php?id=2";
                        }
                    }
                });
                return false;
            }
            else
            {
                alert('Please Fill up Capitalization Cost');
            }
        }
        else
        {
            alert('Please Fill up Description Details');
        }
    }
    else {
        alert('Please Fill up General Details');
    }
}

function sendapproval_new() {
    var vehicle_id = jQuery('#edit_vehicle_id').val();
    if (vehicle_id != '') {
        // editgeo();	            
        if (jQuery("#edit_engineno").val() != "" && jQuery("#chasisno").val() != "")
        {
            if (jQuery("#edit_cap_cost").val() > 1 && jQuery("#edit_cap_cost").val() != "")
            {
                jQuery.ajax({
                    url: "route_ajax.php",
                    type: 'POST',
                    cache: false,
                    data: {approval_vehicle_id: vehicle_id},
                    success: function (statuscheck) {
                        if (statuscheck == "notok") {
                        }
                        else if (statuscheck == "ok") {
                            window.location.href = "vehicle.php?id=2";
                        }
                    }
                });
                return false;
            }
            else
            {
                alert('Please Fill up Capitalization Cost');
            }
        }
        else
        {
            alert('Please Fill up Description Details');
        }
    }
    else {
        alert('Please Fill up General Details');
    }
}


function sendapproval_new_trigon_old() {
    var vehicle_id = jQuery('#edit_vehicle_id').val();
    var formdata = jQuery('#general').serialize();
    jQuery.ajax({
        url: "route_ajax.php",
        type: 'POST',
        cache: false,
        data: {approval_vehicle_id: vehicle_id},
        success: function (statuscheck) {
            if (statuscheck == "notok") {
            }
            else if (statuscheck == "ok") {
                window.location.href = "vehicle.php?id=2";
            }
        }
    });
    return false;
}

function sendapproval_new_trigon(data) {
    var datatest = JSON.stringify(data);
    var vehicle_id = jQuery('#edit_vehicle_id').val();
    var formdata = jQuery('#general').serialize();
    var data = 'action=send_approval&approval_vehicle_id=' + vehicle_id + '&' + formdata + '&olddata=' + datatest;
    jQuery.ajax({
        url: "route_ajax.php",
        type: 'POST',
        cache: false,
        data: data,
        success: function (statuscheck) {
            if (statuscheck == "notok") {
            }
            else if (statuscheck == "ok") {
                window.location.href = "vehicle.php?id=2";
            }
        }
    });
    return false;
}


function editpaper()
{
    var edit_vehicle_id = jQuery('#edit_vehicle_id').val();
    if (edit_vehicle_id != '') {
        var data = jQuery('#editpapers').serialize() + '&edit_vehicle_id=' + edit_vehicle_id;
        jQuery.ajax({
            url: "route_ajax.php",
            type: 'POST',
            cache: false,
            data: data,
            success: function (statuscheck) {
                if (statuscheck == "notok") {
                }
                else if (statuscheck == "ok") {
                    jQuery("#paper_complete").val('done');
                    jQuery("#papers_success").show();
                }
            }
        });
        return false;
    }
    else {
        alert('please fill up general details first!!');
    }

}

function setPUC() {
    if (jQuery('#set_poc').attr('disabled', false)) {
        jQuery("#set_poc").val('Set');
    }
    else {
        jQuery("#set_poc").val('Set');
        jQuery("#set_poc").attr('disabled', false);
    }
}

function setFireext() {
    if (jQuery('#set_fireext').attr('disabled', false)) {
        jQuery("#set_fireext").val('Set');
    }
    else {
        jQuery("#set_fireext").val('Set');
        jQuery("#set_fireext").attr('disabled', false);
    }
}



function setSpeed() {
    if (jQuery('#set_speed_gov').attr('disabled', false)) {
        jQuery("#set_speed_gov").val('Set');
    }
    else {
        jQuery("#set_speed_gov").val('Set');
        jQuery("#set_speed_gov").attr('disabled', false);
    }
}


function setREG() {
    if (jQuery('#set_regi').attr('disabled', false)) {
        jQuery("#set_regi").val('Set');
    }
    else {
        jQuery("#set_regi").val('Set');
        jQuery("#set_regi").attr('disabled', false);
    }
}
function setINS() {
    if (jQuery('#set_INS').attr('disabled', false)) {
        jQuery("#set_INS").val('Set');
    }
    else {
        jQuery("#set_INS").val('Set');
        jQuery("#set_INS").attr('disabled', false);
    }
}
function setOTH1() {
    if (jQuery('#set_OTH1').attr('disabled', false)) {
        jQuery("#set_OTH1").val('Set');
    }
    else {
        jQuery("#set_OTH1").val('Set');
        jQuery("#set_OTH1").attr('disabled', false);
    }
}
function setOTH2() {
    if (jQuery('#set_OTH2').attr('disabled', false)) {
        jQuery("#set_OTH2").val('Set');
    }
    else {
        jQuery("#set_OTH2").val('Set');
        jQuery("#set_OTH2").attr('disabled', false);
    }
}
function setOTH3() {
    if (jQuery('#set_OTH3').attr('disabled', false)) {
        jQuery("#set_OTH3").val('Set');
    }
    else {
        jQuery("#set_OTH3").val('Set');
        jQuery("#set_OTH3").attr('disabled', false);
    }
}

function setOTH4() {
    if (jQuery('#set_OTH4').attr('disabled', false)) {
        jQuery("#set_OTH4").val('Set');
    }
    else {
        jQuery("#set_OTH4").val('Set');
        jQuery("#set_OTH4").attr('disabled', false);
    }
}

function setOTH5() {
    if (jQuery('#set_OTH5').attr('disabled', false)) {
        jQuery("#set_OTH5").val('Set');
    }
    else {
        jQuery("#set_OTH5").val('Set');
        jQuery("#set_OTH5").attr('disabled', false);
    }
}


function setOTH6() {
    if (jQuery('#set_OTH6').attr('disabled', false)) {
        jQuery("#set_OTH6").val('Set');
    }
    else {
        jQuery("#set_OTH6").val('Set');
        jQuery("#set_OTH6").attr('disabled', false);
    }
}


function pucset(vehicleid)
{
    var pucexpiry = jQuery("#ExpiryDate_PUC").val();
    var pucrem = jQuery("#ExpiryDate_PUC_rem").val();
    var customerno = jQuery("#customerno").val();
    var userid = jQuery("#userid").val();
    //alert(vehicleid);
    var data = "vehicleid=" + vehicleid + "&pucexpiry=" + pucexpiry + "&pucrem=" + pucrem + "&customerno=" + customerno + "&userid=" + userid + "&pucset=" + 1;
    //alert(data);
    jQuery.ajax({
        url: "setexpiry.php",
        type: "POST",
        cache: false,
        data: data,
        success: function (json) {
            //alert(json);
            if (json == "Ok") {
                jQuery("#set_poc").val('Saved');
                jQuery("#set_poc").attr('disabled', 'disabled');

            }

        }
    });
}

function speed_gov_set(vehicleid)
{
    var speedexpiry = jQuery("#ExpiryDate_speed").val();
    var speedrem = jQuery("#ExpiryDate_speed_rem").val();
    var customerno = jQuery("#customerno").val();
    var userid = jQuery("#userid").val();
    //alert(vehicleid);
    var data = "vehicleid=" + vehicleid + "&speedexpiry=" + speedexpiry + "&speedrem=" + speedrem + "&customerno=" + customerno + "&userid=" + userid + "&speedset=" + 1;
    //alert(data);
    jQuery.ajax({
        url: "setexpiry.php",
        type: "POST",
        cache: false,
        data: data,
        success: function (json) {
            //alert(json);
            if (json == "Ok") {
                jQuery("#set_speed_gov").val('Saved');
                jQuery("#set_speed_gov").attr('disabled', 'disabled');
            }
        }
    });
}

function fireextset(vehicleid) {
    var fireexpiry = jQuery("#ExpiryDate_fireext").val();
    var fireextrem = jQuery("#ExpiryDate_FIRE_rem").val();
    var customerno = jQuery("#customerno").val();
    var userid = jQuery("#userid").val();
    //alert(vehicleid);
    var data = "vehicleid=" + vehicleid + "&fireexpiry=" + fireexpiry + "&fireextrem=" + fireextrem + "&customerno=" + customerno + "&userid=" + userid + "&fireextset=" + 1;
    //alert(data);
    jQuery.ajax({
        url: "setexpiry.php",
        type: "POST",
        cache: false,
        data: data,
        success: function (json) {
            //alert(json);
            if (json == "Ok") {
                jQuery("#set_fireext").val('Saved');
                jQuery("#set_fireext").attr('disabled', 'disabled');
            }
        }
    });
}


function regset(vehicleid)
{

    var regexpiry = jQuery("#ExpiryDate_REG").val();
    var regrem = jQuery("#ExpiryDate_REG_rem").val();
    var customerno = jQuery("#customerno").val();
    var userid = jQuery("#userid").val();
    //alert(vehicleid);
    var data = "vehicleid=" + vehicleid + "&regexpiry=" + regexpiry + "&regrem=" + regrem + "&customerno=" + customerno + "&userid=" + userid + "&regset=" + 1;
    //alert(data);
    jQuery.ajax({
        url: "setexpiry.php",
        type: "POST",
        cache: false,
        data: data,
        success: function (json) {
            if (json == "Ok") {
                jQuery("#set_regi").val('Saved');
                jQuery("#set_regi").attr('disabled', 'disabled');
            }
        }
    });
}

function insset(vehicleid)
{

    var insexpiry = jQuery("#ExpiryDate_INS").val();
    var insrem = jQuery("#ExpiryDate_INS_rem").val();
    var customerno = jQuery("#customerno").val();
    var userid = jQuery("#userid").val();
    //alert(vehicleid);
    var data = "vehicleid=" + vehicleid + "&insexpiry=" + insexpiry + "&insrem=" + insrem + "&customerno=" + customerno + "&userid=" + userid + "&insset=" + 1;
    //alert(data);
    jQuery.ajax({
        url: "setexpiry.php",
        type: "POST",
        cache: false,
        data: data,
        success: function (json) {
            if (json == "Ok") {
                jQuery("#set_INS").val('Saved');
                jQuery("#set_INS").attr('disabled', 'disabled');
            }
        }
    });
}

function oth1set(vehicleid)
{

    var oth1expiry = jQuery("#ExpiryDate_OTH1").val();
    var oth1rem = jQuery("#ExpiryDate_OTH1_rem").val();
    var customerno = jQuery("#customerno").val();
    var userid = jQuery("#userid").val();
    //alert(vehicleid);
    var data = "vehicleid=" + vehicleid + "&oth1expiry=" + oth1expiry + "&oth1rem=" + oth1rem + "&customerno=" + customerno + "&userid=" + userid + "&oth1set=" + 1;
    //alert(data);
    jQuery.ajax({
        url: "setexpiry.php",
        type: "POST",
        cache: false,
        data: data,
        success: function (json) {
            if (json == "Ok") {
                jQuery("#set_OTH1").val('Saved');
                jQuery("#set_OTH1").attr('disabled', 'disabled');
            }
        }
    });
}

function oth2set(vehicleid)
{

    var oth2expiry = jQuery("#ExpiryDate_OTH2").val();
    var oth2rem = jQuery("#ExpiryDate_OTH2_rem").val();
    var customerno = jQuery("#customerno").val();
    var userid = jQuery("#userid").val();
    //alert(vehicleid);
    var data = "vehicleid=" + vehicleid + "&oth2expiry=" + oth2expiry + "&oth2rem=" + oth2rem + "&customerno=" + customerno + "&userid=" + userid + "&oth2set=" + 1;
    //alert(data);
    jQuery.ajax({
        url: "setexpiry.php",
        type: "POST",
        cache: false,
        data: data,
        success: function (json) {
            if (json == "Ok") {
                jQuery("#set_OTH2").val('Saved');
                jQuery("#set_OTH2").attr('disabled', 'disabled');
            }
        }
    });
}

function oth3set(vehicleid)
{

    var oth3expiry = jQuery("#ExpiryDate_OTH3").val();
    var oth3rem = jQuery("#ExpiryDate_OTH3_rem").val();
    var customerno = jQuery("#customerno").val();
    var userid = jQuery("#userid").val();
    //alert(vehicleid);
    var data = "vehicleid=" + vehicleid + "&oth3expiry=" + oth3expiry + "&oth3rem=" + oth3rem + "&customerno=" + customerno + "&userid=" + userid + "&oth3set=" + 1;
    //alert(data);
    jQuery.ajax({
        url: "setexpiry.php",
        type: "POST",
        cache: false,
        data: data,
        success: function (json) {
            if (json == "Ok") {
                jQuery("#set_OTH3").val('Saved');
                jQuery("#set_OTH3").attr('disabled', 'disabled');
            }
        }
    });
}

function oth4set(vehicleid)
{
    var oth4expiry = jQuery("#ExpiryDate_OTH4").val();
    var oth4rem = jQuery("#ExpiryDate_OTH4_rem").val();
    var customerno = jQuery("#customerno").val();
    var userid = jQuery("#userid").val();
    //alert(vehicleid);
    var data = "vehicleid=" + vehicleid + "&oth4expiry=" + oth4expiry + "&oth4rem=" + oth4rem + "&customerno=" + customerno + "&userid=" + userid + "&oth4set=" + 1;
    //alert(data);
    jQuery.ajax({
        url: "setexpiry.php",
        type: "POST",
        cache: false,
        data: data,
        success: function (json) {
            if (json == "Ok") {
                jQuery("#set_OTH4").val('Saved');
                jQuery("#set_OTH4").attr('disabled', 'disabled');
            }
        }
    });
}


function oth5set(vehicleid)
{
    var oth5expiry = jQuery("#ExpiryDate_OTH5").val();
    var oth5rem = jQuery("#ExpiryDate_OTH5_rem").val();
    var customerno = jQuery("#customerno").val();
    var userid = jQuery("#userid").val();
    //alert(vehicleid);
    var data = "vehicleid=" + vehicleid + "&oth5expiry=" + oth4expiry + "&oth5rem=" + oth4rem + "&customerno=" + customerno + "&userid=" + userid + "&oth5set=" + 1;
    //alert(data);
    jQuery.ajax({
        url: "setexpiry.php",
        type: "POST",
        cache: false,
        data: data,
        success: function (json) {
            if (json == "Ok") {
                jQuery("#set_OTH5").val('Saved');
                jQuery("#set_OTH5").attr('disabled', 'disabled');
            }
        }
    });
}


function oth6set(vehicleid)
{
    var oth6expiry = jQuery("#ExpiryDate_OTH6").val();
    var oth6rem = jQuery("#ExpiryDate_OTH6_rem").val();
    var customerno = jQuery("#customerno").val();
    var userid = jQuery("#userid").val();
    //alert(vehicleid);
    var data = "vehicleid=" + vehicleid + "&oth6expiry=" + oth6expiry + "&oth6rem=" + oth6rem + "&customerno=" + customerno + "&userid=" + userid + "&oth6set=" + 1;
    //alert(data);
    jQuery.ajax({
        url: "setexpiry.php",
        type: "POST",
        cache: false,
        data: data,
        success: function (json) {
            if (json == "Ok") {
                jQuery("#set_OTH6").val('Saved');
                jQuery("#set_OTH6").attr('disabled', 'disabled');
            }
        }
    });
}


var ar_ext = ['pdf'];  // array with allowed extensions
function checkname(fl) {
    var name = fl.value;
    var ar_name = name.split('.');
    //alert(ar_name[1]); 
    if (ar_name[1] != 'pdf') {
        alert("Please Select .PDF file only.");
        fl.value = '';

    }
}

var files;

// Add events
jQuery('#puc').on('change', prepareUploadPUC);
jQuery('#reg').on('change', prepareUploadREG);
jQuery('#insurance').on('change', prepareUploadINS);
jQuery('#fireext').on('change', prepareUploadFireext);
jQuery('#speedgov').on('change', prepareUploadSpeedgov);
jQuery('#other_file').on('change', prepareUploadOTHER);
jQuery('#other1_file').on('change', prepareUploadOTHER1);
jQuery('#other2_file').on('change', prepareUploadOTHER2);
jQuery('#other3_file').on('change', prepareUploadOTHER3);
jQuery('#other4_file').on('change', prepareUploadOTHER4);
jQuery('#other5_file').on('change', prepareUploadOTHER5);

// Grab the files and set them to our variable
function prepareUploadPUC(event)
{
    files = event.target.files;
}



function uploadFilesPUCx(event)
{
    if (jQuery('#puc').val() != '') {
        var edit_vehicle_id = jQuery('#edit_vehicle_id').val();
        var pucname = jQuery('#puc').val();
        var data = new FormData();
        jQuery.each(files, function (key, value)
        {
            data.append(key, value);
        });
        files = null;
        jQuery.ajax({
            url: 'upload.php?vehicleid=' + edit_vehicle_id + '&pucname=' + pucname + '&puc',
            type: 'POST',
            data: data,
            cache: false,
            dataType: 'json',
            processData: false, // Don't process the files
            contentType: false, // Set content type to false as jQuery will tell the server its a query string request
            success: function (data, textStatus, jqXHR)
            {
                if (typeof data.error === 'undefined')
                {

                    submitForm_PUC(event, data);
//                    jQuery("#upload_puc").val('Upload Successfully');
//                    jQuery("#upload_puc").attr('disabled', 'disabled');
//                    jQuery("#puc").hide();
                }
                else
                {
                    // Handle errors here
                    console.log('ERRORS: ' + data.error);
                }
            },
            error: function (jqXHR, textStatus, errorThrown)
            {
                // Handle errors here
                console.log('ERRORS: ' + textStatus);
                // STOP LOADING SPINNER
            }
        });
    }
    else {
        alert('please select a file to upload');
        files = null;
    }
}
function submitForm_PUC(event, data)
{
    // Create a jQuery object from the form
    //$form = jQuery(event.target);
    // Serialize the form data

    var vehicle_id = jQuery('#edit_vehicle_id').val();
    var filename3 = jQuery('#puc').val();
    var data = '&other_vehicleid=' + vehicle_id + '&filename=' + filename3 + '&puc_submit=true';
    jQuery.ajax({
        url: "route_ajax.php",
        type: 'POST',
        cache: false,
        data: data,
        success: function (statuscheck) {
            if (statuscheck == "notok") {
                submitForm_PUC(event, data);
            }
            else if (statuscheck == "ok") {
                jQuery("#upload_puc").val('Upload Successfully');
                jQuery("#upload_puc").attr('disabled', 'disabled');
                jQuery("#puc").hide();
            }
        }
    });
}

function uploadFilesspeed_gov(event)
{
    if (jQuery('#speedgov').val() != '') {
        var edit_vehicle_id = jQuery('#edit_vehicle_id').val();
        var speedname = jQuery('#speedgov').val();
        var data = new FormData();
        jQuery.each(files, function (key, value)
        {
            data.append(key, value);
        });
        files = null;
        jQuery.ajax({
            url: 'upload.php?vehicleid=' + edit_vehicle_id + '&speedname=' + speedname + '&speedgov',
            type: 'POST',
            data: data,
            cache: false,
            dataType: 'json',
            processData: false, // Don't process the files
            contentType: false, // Set content type to false as jQuery will tell the server its a query string request
            success: function (data, textStatus, jqXHR)
            {
                if (typeof data.error === 'undefined')
                {

                    submitForm_SPEED(event, data);
//                    jQuery("#upload_puc").val('Upload Successfully');
//                    jQuery("#upload_puc").attr('disabled', 'disabled');
//                    jQuery("#puc").hide();
                }
                else
                {
                    // Handle errors here
                    console.log('ERRORS: ' + data.error);
                }
            },
            error: function (jqXHR, textStatus, errorThrown)
            {
                // Handle errors here
                console.log('ERRORS: ' + textStatus);
                // STOP LOADING SPINNER
            }
        });
    }
    else {
        alert('please select a file to upload');
        files = null;
    }
}

function submitForm_SPEED(event, data)
{
    // Create a jQuery object from the form
    //$form = jQuery(event.target);
    // Serialize the form data

    var vehicle_id = jQuery('#edit_vehicle_id').val();
    var filename3 = jQuery('#speedgov').val();
    var data = '&other_vehicleid=' + vehicle_id + '&filename=' + filename3 + '&speedgov_submit=true';
    jQuery.ajax({
        url: "route_ajax.php",
        type: 'POST',
        cache: false,
        data: data,
        success: function (statuscheck) {
            if (statuscheck == "notok") {
                submitForm_SPEED(event, data);
            }
            else if (statuscheck == "ok") {
                jQuery("#upload_speedgov").val('Upload Successfully');
                jQuery("#upload_speedgov").attr('disabled', 'disabled');
                jQuery("#speedgov").hide();
            }
        }
    });
}



function uploadFilesFireext(event)
{
    if (jQuery('#fireext').val() != '') {
        var edit_vehicle_id = jQuery('#edit_vehicle_id').val();
        var fireextname = jQuery('#fireext').val();
        var data = new FormData();
        jQuery.each(files, function (key, value)
        {
            data.append(key, value);
        });
        files = null;
        jQuery.ajax({
            url: 'upload.php?vehicleid=' + edit_vehicle_id + '&fireextname=' + fireextname + '&fireext',
            type: 'POST',
            data: data,
            cache: false,
            dataType: 'json',
            processData: false, // Don't process the files
            contentType: false, // Set content type to false as jQuery will tell the server its a query string request
            success: function (data, textStatus, jqXHR)
            {
                if (typeof data.error === 'undefined')
                {

                    submitForm_FIREEXT(event, data);
//                    jQuery("#upload_puc").val('Upload Successfully');
//                    jQuery("#upload_puc").attr('disabled', 'disabled');
//                    jQuery("#puc").hide();
                }
                else
                {
                    // Handle errors here
                    console.log('ERRORS: ' + data.error);
                }
            },
            error: function (jqXHR, textStatus, errorThrown)
            {
                // Handle errors here
                console.log('ERRORS: ' + textStatus);
                // STOP LOADING SPINNER
            }
        });
    }
    else {
        alert('please select a file to upload');
        files = null;
    }
}


function submitForm_FIREEXT(event, data)
{
    // Create a jQuery object from the form
    //$form = jQuery(event.target);
    // Serialize the form data

    var vehicle_id = jQuery('#edit_vehicle_id').val();
    var filename3 = jQuery('#fireext').val();
    var data = '&other_vehicleid=' + vehicle_id + '&filename=' + filename3 + '&fireext_submit=true';
    jQuery.ajax({
        url: "route_ajax.php",
        type: 'POST',
        cache: false,
        data: data,
        success: function (statuscheck) {
            if (statuscheck == "notok") {
                submitForm_FIREEXT(event, data);
            }
            else if (statuscheck == "ok") {
                jQuery("#upload_fire").val('Upload Successfully');
                jQuery("#upload_fire").attr('disabled', 'disabled');
                jQuery("#fireext").hide();
            }
        }
    });
}

var files_reg;
function prepareUploadREG(event)
{
    files_reg = event.target.files;
}

function uploadFilesREG(event)
{
    if (jQuery('#reg').val() != '') {

        var edit_vehicle_id = jQuery('#edit_vehicle_id').val();
        var reg = jQuery('#reg').val();

        var datareg = new FormData();
        jQuery.each(files_reg, function (key, value)
        {
            datareg.append(key, value);
        });
        files_reg = null;
        jQuery.ajax({
            url: 'upload.php?vehicleid=' + edit_vehicle_id + '&reg=' + reg + '&reg',
            type: 'POST',
            data: datareg,
            cache: false,
            dataType: 'json',
            processData: false, // Don't process the files
            contentType: false, // Set content type to false as jQuery will tell the server its a query string request
            success: function (data, textStatus, jqXHR)
            {
                if (typeof data.error === 'undefined')
                {
                    submitForm_REG(event, data);
                }
                else
                {
                    // Handle errors here
                    console.log('ERRORS: ' + data.error);
                }
            },
            error: function (jqXHR, textStatus, errorThrown)
            {
                // Handle errors here
                console.log('ERRORS: ' + textStatus);
                // STOP LOADING SPINNER
            }
        });
    }
    else {
        alert('please select a file to upload');
        files_reg = null;
    }
}


function submitForm_REG(event, data)
{
    // Create a jQuery object from the form
    //$form = jQuery(event.target);
    // Serialize the form data
    var vehicle_id = jQuery('#edit_vehicle_id').val();
    var filename3 = jQuery('#reg').val();
    var data = '&other_vehicleid=' + vehicle_id + '&filename=' + filename3 + '&reg_submit=true';
    jQuery.ajax({
        url: "route_ajax.php",
        type: 'POST',
        cache: false,
        data: data,
        success: function (statuscheck) {
            if (statuscheck == "notok") {

            }
            else if (statuscheck == "ok") {
                jQuery("#upload_reg").val('Upload Successfully');
                jQuery("#upload_reg").attr('disabled', 'disabled');
                jQuery("#reg").hide();
            }
        }
    });
}


var files_speed;
function prepareUploadSpeedgov(event) {
    files_speed = event.target.files;
}

var fire_ext;

function prepareUploadFireext(event) {
    fire_ext = event.target.files;
}


var files_ins;
function prepareUploadINS(event)
{
    files_ins = event.target.files;
}

function uploadFilesINS(event)
{
    if (jQuery('#insurance').val() != '') {

        var edit_vehicle_id = jQuery('#edit_vehicle_id').val();
        var insurance = jQuery('#insurance').val();
        var datains = new FormData();
        jQuery.each(files_ins, function (key, value)
        {
            datains.append(key, value);
        });
        files_ins = null;
        jQuery.ajax({
            url: 'upload.php?vehicleid=' + edit_vehicle_id + '&insurance=' + insurance + '&ins',
            type: 'POST',
            data: datains,
            cache: false,
            dataType: 'json',
            processData: false, // Don't process the files
            contentType: false, // Set content type to false as jQuery will tell the server its a query string request
            success: function (data, textStatus, jqXHR)
            {
                if (typeof data.error === 'undefined')
                {
                    submitForm_Insurance(event, data);


                }
                else
                {
                    // Handle errors here
                    console.log('ERRORS: ' + data.error);
                }
            },
            error: function (jqXHR, textStatus, errorThrown)
            {
                // Handle errors here
                console.log('ERRORS: ' + textStatus);
                // STOP LOADING SPINNER
            }
        });
    }
    else {
        alert('please select a file to upload');
        files_ins = null;
    }
}

function submitForm_Insurance(event, data)
{
    // Create a jQuery object from the form
    //$form = jQuery(event.target);
    // Serialize the form data
    var vehicle_id = jQuery('#edit_vehicle_id').val();
    var filename3 = jQuery('#insurance').val();
    var data = '&other_vehicleid=' + vehicle_id + '&filename=' + filename3 + '&insurance_submit=true';
    jQuery.ajax({
        url: "route_ajax.php",
        type: 'POST',
        cache: false,
        data: data,
        success: function (statuscheck) {
            if (statuscheck == "notok") {

            }
            else if (statuscheck == "ok") {
                jQuery("#upload_ins").val('Upload Successfully');
                jQuery("#upload_ins").attr('disabled', 'disabled');
                jQuery("#insurance").hide();
            }
        }
    });
}


var files_other;
function prepareUploadOTHER(event)
{
    files_other = event.target.files;
}

function uploadFilesOTHER(event)
{

    var edit_vehicle_id = jQuery('#edit_vehicle_id').val();
    var othername = jQuery('#other').val();
    if (jQuery('#other_file').val() == '') {
        alert('please select a file to upload');
    }
    else if (othername != '') {
        var dataother = new FormData();
        jQuery.each(files_other, function (key, value)
        {
            dataother.append(key, value);
        });
        files_other = null;
        jQuery.ajax({
            url: 'upload.php?vehicleid=' + edit_vehicle_id + '&othername=' + othername + '&other',
            type: 'POST',
            data: dataother,
            cache: false,
            dataType: 'json',
            processData: false, // Don't process the files
            contentType: false, // Set content type to false as jQuery will tell the server its a query string request
            success: function (data, textStatus, jqXHR)
            {
                if (typeof data.error === 'undefined')
                {
                    // Success so call function to process the form
                    submitForm_Other(event, data);
                }
                else
                {
                    // Handle errors here
                    console.log('ERRORS: ' + data.error);
                }
            },
            error: function (jqXHR, textStatus, errorThrown)
            {
                // Handle errors here
                console.log('ERRORS: ' + textStatus);
                // STOP LOADING SPINNER
            }
        });
    }
    else {
        alert('please enter name for other documents, if any');
    }
}

var files_other1;
function prepareUploadOTHER1(event)
{
    files_other1 = event.target.files;
}

function uploadFilesOTHER1(event)
{


    var edit_vehicle_id = jQuery('#edit_vehicle_id').val();
    var othername1 = jQuery('#other1').val();
    if (jQuery('#other1_file').val() == '') {
        alert('please select a file to upload');
    }
    else if (othername1 != '') {
        var dataother1 = new FormData();
        jQuery.each(files_other1, function (key, value)
        {
            dataother1.append(key, value);
        });
        files_other1 = null;
        jQuery.ajax({
            url: 'upload.php?vehicleid=' + edit_vehicle_id + '&othername1=' + othername1 + '&other1',
            type: 'POST',
            data: dataother1,
            cache: false,
            dataType: 'json',
            processData: false, // Don't process the files
            contentType: false, // Set content type to false as jQuery will tell the server its a query string request
            success: function (data, textStatus, jqXHR)
            {
                if (typeof data.error === 'undefined')
                {
                    // Success so call function to process the form
                    submitForm_Other1(event, data);
                }
                else
                {
                    // Handle errors here
                    console.log('ERRORS: ' + data.error);
                }
            },
            error: function (jqXHR, textStatus, errorThrown)
            {
                // Handle errors here
                console.log('ERRORS: ' + textStatus);
                // STOP LOADING SPINNER
            }
        });
    }
    else {
        alert('please enter name for other documents, if any');
    }
}

var files_other2;
function prepareUploadOTHER2(event)
{
    files_other2 = event.target.files;
}

function uploadFilesOTHER2(event)
{

    var edit_vehicle_id = jQuery('#edit_vehicle_id').val();
    var othername2 = jQuery('#other2').val();
    if (jQuery('#other2_file').val() == '') {
        alert('please select a file to upload');
    }
    else if (othername2 != '') {
        var dataother2 = new FormData();
        jQuery.each(files_other2, function (key, value)
        {
            dataother2.append(key, value);
        });
        files_other2 = null;
        jQuery.ajax({
            url: 'upload.php?vehicleid=' + edit_vehicle_id + '&othername2=' + othername2 + '&other2',
            type: 'POST',
            data: dataother2,
            cache: false,
            dataType: 'json',
            processData: false, // Don't process the files
            contentType: false, // Set content type to false as jQuery will tell the server its a query string request
            success: function (data, textStatus, jqXHR)
            {
                if (typeof data.error === 'undefined')
                {
                    // Success so call function to process the form
                    submitForm_Other2(event, data);
                }
                else
                {
                    // Handle errors here
                    console.log('ERRORS: ' + data.error);
                }
            },
            error: function (jqXHR, textStatus, errorThrown)
            {
                // Handle errors here
                console.log('ERRORS: ' + textStatus);
                // STOP LOADING SPINNER
            }
        });
    }
    else {
        alert('please enter name for other documents, if any');
    }
}

var files_other3;
function prepareUploadOTHER3(event)
{
    files_other3 = event.target.files;
}

var files_other4;
function prepareUploadOTHER4(event)
{
    files_other4 = event.target.files;
}

var files_other5;
function prepareUploadOTHER5(event)
{
    files_other5 = event.target.files;
}


function uploadFilesOTHER3(event)
{
    var edit_vehicle_id = jQuery('#edit_vehicle_id').val();
    var othername3 = jQuery('#other3').val();
    if (jQuery('#other3_file').val() == '') {
        alert('please select a file to upload');
    }
    else if (othername3 != '') {
        var dataother3 = new FormData();
        jQuery.each(files_other3, function (key, value)
        {
            dataother3.append(key, value);
        });
        files_other3 = null;
        jQuery.ajax({
            url: 'upload.php?vehicleid=' + edit_vehicle_id + '&othername3=' + othername3 + '&other3',
            type: 'POST',
            data: dataother3,
            cache: false,
            dataType: 'json',
            processData: false, // Don't process the files
            contentType: false, // Set content type to false as jQuery will tell the server its a query string request
            success: function (data, textStatus, jqXHR)
            {
                if (typeof data.error === 'undefined')
                {
                    // Success so call function to process the form
                    submitForm_Other3(event, data);
                }
                else
                {
                    // Handle errors here
                    console.log('ERRORS: ' + data.error);
                }
            },
            error: function (jqXHR, textStatus, errorThrown)
            {
                // Handle errors here
                console.log('ERRORS: ' + textStatus);
                // STOP LOADING SPINNER
            }
        });
    }
    else {
        alert('please enter name for other documents, if any');
    }
}

function uploadFilesOTHER4(event)
{
    var edit_vehicle_id = jQuery('#edit_vehicle_id').val();
    var othername4 = jQuery('#other4').val();
    if (jQuery('#other4_file').val() == '') {
        alert('please select a file to upload');
    }
    else if (othername4 != '') {
        var dataother4 = new FormData();
        jQuery.each(files_other4, function (key, value)
        {
            dataother4.append(key, value);
        });
        files_other4 = null;
        jQuery.ajax({
            url: 'upload.php?vehicleid=' + edit_vehicle_id + '&othername4=' + othername4 + '&other4',
            type: 'POST',
            data: dataother4,
            cache: false,
            dataType: 'json',
            processData: false, // Don't process the files
            contentType: false, // Set content type to false as jQuery will tell the server its a query string request
            success: function (data, textStatus, jqXHR)
            {
                if (typeof data.error === 'undefined')
                {
                    // Success so call function to process the form
                    submitForm_Other4(event, data);
                }
                else
                {
                    // Handle errors here
                    console.log('ERRORS: ' + data.error);
                }
            },
            error: function (jqXHR, textStatus, errorThrown)
            {
                // Handle errors here
                console.log('ERRORS: ' + textStatus);
                // STOP LOADING SPINNER
            }
        });
    }
    else {
        alert('please enter name for other documents, if any');
    }
}


function uploadFilesOTHER5(event)
{
    var edit_vehicle_id = jQuery('#edit_vehicle_id').val();
    var othername5 = jQuery('#other5').val();
    if (jQuery('#other5_file').val() == '') {
        alert('please select a file to upload');
    }
    else if (othername5 != '') {
        var dataother5 = new FormData();
        jQuery.each(files_other5, function (key, value)
        {
            dataother5.append(key, value);
        });
        files_other5 = null;
        jQuery.ajax({
            url: 'upload.php?vehicleid=' + edit_vehicle_id + '&othername5=' + othername5 + '&other5',
            type: 'POST',
            data: dataother5,
            cache: false,
            dataType: 'json',
            processData: false, // Don't process the files
            contentType: false, // Set content type to false as jQuery will tell the server its a query string request
            success: function (data, textStatus, jqXHR)
            {
                if (typeof data.error === 'undefined')
                {
                    // Success so call function to process the form
                    submitForm_Other5(event, data);
                }
                else
                {
                    // Handle errors here
                    console.log('ERRORS: ' + data.error);
                }
            },
            error: function (jqXHR, textStatus, errorThrown)
            {
                // Handle errors here
                console.log('ERRORS: ' + textStatus);
                // STOP LOADING SPINNER
            }
        });
    }
    else {
        alert('please enter name for other documents, if any');
    }
}



function submitForm_Other(event, data)
{
    // Create a jQuery object from the form
    //$form = jQuery(event.target);

    // Serialize the form data
    var vehicle_id = jQuery('#edit_vehicle_id').val();
    var filename = jQuery('#other').val();
    //var formData = jQuery('#general').serialize();
    var data = '&other_vehicleid=' + vehicle_id + '&filename=' + filename + '&other_submit=true';
    jQuery.ajax({
        url: "route_ajax.php",
        type: 'POST',
        cache: false,
        data: data,
        success: function (statuscheck) {
            if (statuscheck == "notok") {
            }
            else if (statuscheck == "ok") {
                jQuery("#upload_other").val('Upload Successfully');
                jQuery("#upload_other").attr('disabled', 'disabled');
                jQuery("#other_file").hide();
            }
        }
    });
}

function submitForm_Other1(event, data)
{
    // Create a jQuery object from the form
    //$form = jQuery(event.target);

    // Serialize the form data
    var vehicle_id = jQuery('#edit_vehicle_id').val();
    var filename1 = jQuery('#other1').val();
    //var formData = jQuery('#general').serialize();
    var data = '&other_vehicleid=' + vehicle_id + '&filename=' + filename1 + '&other_submit1=true';
    jQuery.ajax({
        url: "route_ajax.php",
        type: 'POST',
        cache: false,
        data: data,
        success: function (statuscheck) {
            if (statuscheck == "notok") {
            }
            else if (statuscheck == "ok") {
                jQuery("#upload_other1").val('Upload Successfully');
                jQuery("#upload_other1").attr('disabled', 'disabled');
                jQuery("#other1_file").hide();
            }
        }
    });
}

function submitForm_Other2(event, data)
{
    // Create a jQuery object from the form
    //$form = jQuery(event.target);

    // Serialize the form data
    var vehicle_id = jQuery('#edit_vehicle_id').val();
    var filename2 = jQuery('#other2').val();
    //var formData = jQuery('#general').serialize();
    var data = '&other_vehicleid=' + vehicle_id + '&filename=' + filename2 + '&other_submit2=true';
    jQuery.ajax({
        url: "route_ajax.php",
        type: 'POST',
        cache: false,
        data: data,
        success: function (statuscheck) {
            if (statuscheck == "notok") {
            }
            else if (statuscheck == "ok") {
                jQuery("#upload_other2").val('Upload Successfully');
                jQuery("#upload_other2").attr('disabled', 'disabled');
                jQuery("#other2_file").hide();
            }
        }
    });
}


function submitForm_Other3(event, data)
{
    // Create a jQuery object from the form
    //$form = jQuery(event.target);

    // Serialize the form data
    var vehicle_id = jQuery('#edit_vehicle_id').val();
    var filename3 = jQuery('#other3').val();
    //var formData = jQuery('#general').serialize();
    var data = '&other_vehicleid=' + vehicle_id + '&filename=' + filename3 + '&other_submit3=true';
    jQuery.ajax({
        url: "route_ajax.php",
        type: 'POST',
        cache: false,
        data: data,
        success: function (statuscheck) {
            if (statuscheck == "notok") {
            }
            else if (statuscheck == "ok") {
                jQuery("#upload_other3").val('Upload Successfully');
                jQuery("#upload_other3").attr('disabled', 'disabled');
                jQuery("#other3_file").hide();
            }
        }
    });
}


function submitForm_Other4(event, data)
{
    // Create a jQuery object from the form
    //$form = jQuery(event.target);

    // Serialize the form data
    var vehicle_id = jQuery('#edit_vehicle_id').val();
    var filename4 = jQuery('#other4').val();
    //var formData = jQuery('#general').serialize();
    var data = '&other_vehicleid=' + vehicle_id + '&filename=' + filename4 + '&other_submit4=true';
    jQuery.ajax({
        url: "route_ajax.php",
        type: 'POST',
        cache: false,
        data: data,
        success: function (statuscheck) {
            if (statuscheck == "notok") {
            }
            else if (statuscheck == "ok") {
                jQuery("#upload_other4").val('Upload Successfully');
                jQuery("#upload_other4").attr('disabled', 'disabled');
                jQuery("#other4_file").hide();
            }
        }
    });
}



function submitForm_Other5(event, data)
{
    // Create a jQuery object from the form
    //$form = jQuery(event.target);

    // Serialize the form data
    var vehicle_id = jQuery('#edit_vehicle_id').val();
    var filename4 = jQuery('#other5').val();
    //var formData = jQuery('#general').serialize();
    var data = '&other_vehicleid=' + vehicle_id + '&filename=' + filename5 + '&other_submit5=true';
    jQuery.ajax({
        url: "route_ajax.php",
        type: 'POST',
        cache: false,
        data: data,
        success: function (statuscheck) {
            if (statuscheck == "notok") {
            }
            else if (statuscheck == "ok") {
                jQuery("#upload_other5").val('Upload Successfully');
                jQuery("#upload_other5").attr('disabled', 'disabled');
                jQuery("#other5_file").hide();
            }
        }
    });
}



function mappedcheckpoints() {
    jQuery('.mappedchkpt').each(function () {
        var chkptid = jQuery(this).attr('rel');
        var chkptname = jQuery(this).val();
        ldchkpt(chkptname, chkptid);
    });
}
function ldchkpt(chkptname, chkptid)
{
    var selected_name = chkptname;
    if (chkptid > -1 && jQuery('#to_checkpoint_div_' + chkptid).val() == null)
    {
        var div = document.createElement('div');
        var remove_image = document.createElement('img');
        remove_image.src = "../../images/boxdelete.png";
        remove_image.className = 'clickimage';
        remove_image.onclick = function () {
            removechkpt(chkptid);
        };
        div.className = 'recipientbox';
        div.id = 'to_checkpoint_div_' + chkptid;
        div.innerHTML = '<span>' + selected_name + '</span><input type="hidden" name="to_checkpoint_' + chkptid + '" value="' + chkptid + '"/>';
        jQuery('#checkpoint_list').append(div);
        jQuery(div).append(remove_image);
    }
}

function removechkpt(chkptid) {
    if (chkptid > -1 && jQuery('#to_checkpoint_div_' + chkptid).val() != null) {
        jQuery('#to_checkpoint_div_' + chkptid).remove();
    }
}

function mappedfences() {
    jQuery('.mappedfence').each(function () {
        var fenceid = jQuery(this).attr('rel');
        var fencename = jQuery(this).val();
        ldfence(fencename, fenceid);
    });
}
function ldfence(fencename, fenceid)
{
    var selected_name = fencename;
    if (fenceid > -1 && jQuery('#to_fence_div_' + fenceid).val() == null)
    {
        var div = document.createElement('div');
        var remove_image = document.createElement('img');
        remove_image.src = "../../images/boxdelete.png";
        remove_image.className = 'clickimage';
        remove_image.onclick = function () {
            removefence(fenceid);
        };
        div.className = 'recipientbox';
        div.id = 'to_fence_div_' + fenceid;
        div.innerHTML = '<span>' + selected_name + '</span><input type="hidden" name="to_fence_' + fenceid + '" value="' + fenceid + '"/>';
        jQuery('#fence_list').append(div);
        jQuery(div).append(remove_image);
    }
}

function removefence(fenceid) {
    if (fenceid > -1 && jQuery('#to_fence_div_' + fenceid).val() != null) {
        jQuery('#to_fence_div_' + fenceid).remove();
    }
}

function push_transaction_accident() {
    var vehicle_id = jQuery('#edit_vehicle_id').val();
    var atpos = jQuery("#addaccident #send_report").val().indexOf("@");
    var dotpos = jQuery("#addaccident #send_report").val().lastIndexOf(".");
    var from_date = jQuery("#addaccident #val_from_Date").val();
    var to_date = jQuery("#addaccident #val_to_Date").val();
    var datediff = daydiff(parseDate(from_date), parseDate(to_date));

    if (jQuery("#addaccident #acc_location").val() == "")
    {
        jQuery("#addaccident #al_error").show();
        jQuery("#addaccident #al_error").fadeOut(6000);
    }
    else if (jQuery("#addaccident #acc_desc").val() == "")
    {
        jQuery("#addaccident #ad_error").show();
        jQuery("#addaccident #ad_error").fadeOut(6000);
    }
    else if (jQuery("#addaccident #driver_name").val() == "")
    {
        jQuery("#addaccident #dn_error").show();
        jQuery("#addaccident #dn_error").fadeOut(6000);
    }
    else if (jQuery("#addaccident #send_report").val() != '' && (atpos < 1 || dotpos < atpos + 2 || dotpos + 2 >= jQuery("#addaccident #send_report").val().length))
    {
        jQuery("#addaccident #email_error").show();
        jQuery("#addaccident #email_error").fadeOut(6000);
    }
    else if (datediff < 0)
    {
        jQuery("#addaccident #date_conflict_error").show();
        jQuery("#addaccident #date_conflict_error").fadeOut(6000);
    }
    else if (vehicle_id != '') {
        var data = jQuery('#getaccident_approval').serialize() + '&accident_vehicleid=' + vehicle_id;
        //alert(data);exit;
        jQuery.ajax({
            url: "route_ajax.php",
            type: 'POST',
            cache: false,
            data: data,
            success: function (statuscheck) {
                if (statuscheck == "notok") {
                    jQuery(".file-input-name").html("");
                }
                else if (statuscheck == "ok") {
                    jQuery(".file-input-name").html("");
                    jQuery('#addaccident').modal('hide');
                    getaccident();
                    jQuery('#getaccident_approval')[0].reset();
                }
            }
        });
        return false;
    }
    else {
        alert('please fill up general details first!!');
    }

}
function upload(id) {
    uploadFilesPUC(event, id);
}
function prepareUploadPUC(event)
{
    acc_files = event.target.files;
}

function uploadFilesPUC(event, id)
{
    var uploadfile;
    //alert(id);
    if (id == '1')
        uploadfile = jQuery('#file1').val();
    else if (id == '2')
        uploadfile = jQuery('#file2').val();
    else if (id == '3')
        uploadfile = jQuery('#file3').val();
    else if (id == '4')
        uploadfile = jQuery('#file4').val();
    else if (id == '5')
        uploadfile = jQuery('#file5').val();

    if (uploadfile != '') {
        //event.stopPropagation(); // Stop stuff happening
        //event.preventDefault(); // Totally stop stuff happening

        // START A LOADING SPINNER HERE

        // Create a formdata object and add the files
        var vehicle_id = jQuery('#vehicle_id').val();
        var data = new FormData();
        jQuery.each(files, function (key, value)
        {
            data.append(key, value);
        });
        files = null;
        jQuery.ajax({
            url: 'upload.php?vehicleid=' + vehicle_id + '&acc_file=' + id,
            type: 'POST',
            data: data,
            cache: false,
            dataType: 'json',
            processData: false, // Don't process the files
            contentType: false, // Set content type to false as jQuery will tell the server its a query string request
            success: function (data, textStatus, jqXHR)
            {
                if (typeof data.error === 'undefined')
                {
                    jQuery("#upload_file" + id).val('Upload Successful');
                    jQuery("#upload_file" + id).attr('disabled', 'disabled');
                }
                else
                {
                    // Handle errors here
                    console.log('ERRORS: ' + data.error);
                }
            },
            error: function (jqXHR, textStatus, errorThrown)
            {
                // Handle errors here
                console.log('ERRORS: ' + textStatus);
                // STOP LOADING SPINNER
            }
        });
    }
    else {
        alert('please select a file to upload');
        files = null;
    }
}
var files;

// Add events
jQuery('input[type=file]').on('change', prepareUpload);

// Grab the files and set them to our variable
function prepareUpload(event)
{
    files = event.target.files;

}

function sel_acc(num)
{
    var accessory = jQuery("#accessory_select_" + num).val();
    jQuery('#max_amount_' + num).text(0);
    jQuery('#max_amount_hid_' + num).val(0);
    if (accessory != '-1') {
        jQuery.ajax({
            url: "route_ajax.php",
            dataType: "json",
            type: 'POST',
            cache: false,
            data: {accessory_id: accessory},
            success: function (data) {
                jQuery('#max_amount_' + num).text(data);
                jQuery('#max_amount_hid_' + num).val(data);
            }
        });
        return false;
    }
}

function insurance_date()
{
    var enddate = jQuery("#EndDate").val();
    var parts = enddate.split("-");
    var dt = new Date(parseInt(parts[2], 10),
            parseInt(parts[1], 10) - 1,
            parseInt(parts[0], 10));
    var x = 364; // go back 364 days!
    //alert(dt);
    var date_subtract = dt.setDate(dt.getDate() - x);
    var d = new Date(date_subtract);
    var cd = convert(d);
    //alert(cd);
    jQuery("#StartDate").val(cd);
    jQuery("#ExpiryDate_INS").val(enddate);
}

function convert(str) {// to convert date to dd-mm-yyyy from full date & time in gmt
    var date = new Date(str),
            mnth = ("0" + (date.getMonth() + 1)).slice(-2),
            day = ("0" + date.getDate()).slice(-2);
    return [day, mnth, date.getFullYear()].join("-");
}
